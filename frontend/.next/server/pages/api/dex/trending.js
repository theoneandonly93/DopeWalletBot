"use strict";(()=>{var e={};e.id=840,e.ids=[840],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,n){return n in t?t[n]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,n)):"function"==typeof t&&"default"===n?t:void 0}}})},4225:(e,t,n)=>{n.r(t),n.d(t,{config:()=>h,default:()=>f,routeModule:()=>b});var o={};n.r(o),n.d(o,{default:()=>d});var a=n(1802),s=n(7153),r=n(6249);let l=process.env.DEX_API_URL||"https://api.dexscreener.com/latest/dex",i={responses:{},tokenlist:null,tokenlistTs:0,logoMap:null},c={list:null,listTs:0,prices:{},pricesTs:{}};async function m(){let e=Date.now();if(c.list&&e-c.listTs<36e5)return c.list;try{let e=await fetch("https://api.coingecko.com/api/v3/coins/list");if(!e.ok)return null;let t=await e.json(),n={};for(let e of t||[])try{let t=String(e.symbol||"").toUpperCase();n[t]||(n[t]=e.id)}catch(e){}return c.list=n,c.listTs=Date.now(),n}catch(e){return null}}async function u(e,t,n){try{let o=Date.now(),a=`${e}:${(t||"").toLowerCase()}`;if(c.meta[a]&&o-(c.meta[a].ts||0)<6e5)return c.meta[a].data;if(t)try{let n=`https://api.coingecko.com/api/v3/coins/${encodeURIComponent({solana:"solana",bsc:"binance-smart-chain",bscscan:"binance-smart-chain",ethereum:"ethereum",polygon:"polygon-pos",fantom:"fantom"}[e]||e)}/contract/${encodeURIComponent(t)}`,o=await fetch(n);if(o.ok){let e=await o.json(),t={name:e.name||null,symbol:e.symbol||null};return c.meta[a]={ts:Date.now(),data:t},t}}catch(e){}let s=await m();if(s&&n){let e=s[String(n).toUpperCase()];if(e)try{let t=await fetch(`https://api.coingecko.com/api/v3/coins/${encodeURIComponent(e)}`);if(t.ok){let e=await t.json(),n={name:e.name||null,symbol:e.symbol||null};return c.meta[a]={ts:Date.now(),data:n},n}}catch(e){}}c.meta[a]={ts:Date.now(),data:{name:null,symbol:null}}}catch(e){}return{name:null,symbol:null}}async function p(){let e=Date.now();if(i.tokenlist&&e-i.tokenlistTs<6e4)return i.tokenlist;try{let e=await fetch("https://raw.githubusercontent.com/solana-labs/token-list/main/src/tokens/solana.tokenlist.json");if(!e.ok)return null;let t=await e.json(),n={};for(let e of t.tokens||[])try{let t=String(e.address||"").toLowerCase();t&&(n[t]=e)}catch(e){}let o={};for(let e of t.tokens||[]){let t=e.logoURI||e.extensions?.logoURI||"";if(t)try{let n=String(t).split("/"),a=n[n.length-1]||"";(a=(a=a.split("?")[0]||a).toLowerCase())&&(o[a]=e)}catch(e){}}return i.tokenlist=n,i.logoMap=o,i.tokenlistTs=Date.now(),n}catch(e){return null}}async function d(e,t){try{let{query:n}=e,o=Math.min(Number(n.limit)||100,100),a=(n.chain||"solana").toString().toLowerCase(),s=(n.sort||"volume").toString().toLowerCase(),r=`${a}:${s}:${o}`,c=Date.now();if(i.responses[r]&&c-i.responses[r].ts<3e4)return t.status(200).json({data:i.responses[r].data,cached:!0});let m=[`${l}/${a}`,l,"https://api.dexscreener.com/token-boosts/top/v1"],d=null,f=0;for(let e of m)try{let t=await fetch(e,{headers:{"User-Agent":"DopeWalletBot/1.0"}});if(f=t.status,!t.ok)continue;d=await t.json();break}catch(e){f=500;continue}if(!d)return t.status(502).json({error:"DexScreener upstream error",status:f});let h=[];if(Array.isArray(d))h=d;else if(Array.isArray(d.pairs))h=d.pairs;else for(let e of Object.keys(d||{}))d[e]?.pairs&&Array.isArray(d[e].pairs)&&(h=h.concat(d[e].pairs));let b=(h||[]).filter(e=>[e.chain,e.chainId,e.chainKey,e.dex?.chain,e.pair?.chain,e.baseToken?.chain,e.quoteToken?.chain].filter(Boolean).map(String).join(" ").toLowerCase().includes(a)),y=b;"volume"===s?y=b.sort((e,t)=>(Number(t.volume)||Number(t.volume_24h)||0)-(Number(e.volume)||Number(e.volume_24h)||0)):"gainers"===s&&(y=b.sort((e,t)=>(Number(t.priceChange)||Number(t.change)||0)-(Number(e.priceChange)||Number(e.change)||0)));let g=await p(),k=(y||[]).slice(0,o),w=[];for(let e of k){let t=e.tokenAddress||e.address||e.pairAddress||e.baseToken?.address||e.quoteToken?.address||e.id||"",n=e.icon||e.logo||e.logoURI||e.tokenIcon||e.baseToken?.icon||e.quoteToken?.icon||"",o=e.symbol||e.tokenSymbol||e.token?.symbol||e.baseToken?.symbol||e.quoteToken?.symbol||e.name||"",s=e.name||e.tokenName||e.baseToken?.name||e.quoteToken?.name||"",r=String(t||"").toLowerCase();if((!n||!o)&&g&&r&&g[r]){let e=g[r];n=n||e.logoURI||e.extensions?.logoURI||"",o=o||e.symbol||e.name||""}if((!o||!n)&&i.logoMap)try{let e=n||"";if(e&&!e.startsWith("http"))e=String(e).toLowerCase();else if(e.startsWith("http")){let t=String(e).split("/");e=(t[t.length-1]||"").split("?")[0].toLowerCase()}if(e&&i.logoMap[e]){let t=i.logoMap[e];n=n||t.logoURI||t.extensions?.logoURI||"",o=o||t.symbol||t.name||""}}catch(e){}let l=Number(e.priceUsd||e.price||e.tokenPrice||e.price_usd||e.baseToken?.price||0)||0,c=Number(e.priceChange||e.change||e.change_24h||e.price_change_percentage_24h||0)||0,m=Number(e.volume||e.volume24h||e.volume_24h||e.quoteVolume||e.liquidity||0)||0;!n&&t&&(n=`https://cdn.dexscreener.com/token-images/${a}/${t}`),e.description||e.raw?.description||e.tokenDescription,(e.url||e.raw?.url)&&String(e.url||e.raw?.url).split("/").filter(Boolean).pop();let u=s||"",p=o||"";w.push({address:t,logoURI:n,symbol:p,name:u,price:l,change24h:c,volume24h:m,raw:e})}for(let e of w)try{let t=String(e.address||"").toLowerCase(),n={name:null,symbol:null};if((!e.name||!e.symbol)&&t&&g&&g[t]){let n=g[t];if(n){e.name=e.name||n.name||n.symbol||"",e.symbol=e.symbol||n.symbol||n.name||"";continue}}if((!e.name||!e.symbol)&&e.address&&(n=await u(a,e.address,e.symbol||e.name))&&(n.name&&(e.name=e.name||n.name),n.symbol&&(e.symbol=e.symbol||n.symbol.toUpperCase()),e.name&&e.symbol))continue;e.symbol||(e.symbol=e.name&&e.name.length<=10?e.name.toUpperCase().split(" ")[0]:e.address?`${String(e.address).slice(0,4)}...`:""),e.name||(e.name=e.raw?.name||e.raw?.tokenName||e.raw?.description||"")}catch(e){}return i.responses[r]={ts:Date.now(),data:w},t.status(200).json({data:w,cached:!1})}catch(e){return console.error("trending proxy error",e),t.status(500).json({error:String(e)})}}c.meta={};let f=(0,r.l)(o,"default"),h=(0,r.l)(o,"config"),b=new a.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/dex/trending",pathname:"/api/dex/trending",bundlePath:"",filename:""},userland:o})},7153:(e,t)=>{var n;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return n}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(n||(n={}))},1802:(e,t,n)=>{e.exports=n(145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var n=t(t.s=4225);module.exports=n})();