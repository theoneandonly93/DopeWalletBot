"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/dex/trending";
exports.ids = ["pages/api/dex/trending"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdex%2Ftrending&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fdex%2Ftrending.js&middlewareConfigBase64=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdex%2Ftrending&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fdex%2Ftrending.js&middlewareConfigBase64=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_dex_trending_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/dex/trending.js */ \"(api)/./pages/api/dex/trending.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_dex_trending_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_dex_trending_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/dex/trending\",\n        pathname: \"/api/dex/trending\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_dex_trending_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmRleCUyRnRyZW5kaW5nJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlMkZhcGklMkZkZXglMkZ0cmVuZGluZy5qcyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUN3RDtBQUN4RDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsdURBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLHVEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCIsInNvdXJjZXMiOlsid2VicGFjazovL2RvcGV3YWxsZXQtZnJvbnRlbmQvPzczMDAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzL2FwaS9kZXgvdHJlbmRpbmcuanNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9kZXgvdHJlbmRpbmdcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9kZXgvdHJlbmRpbmdcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdex%2Ftrending&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fdex%2Ftrending.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/dex/trending.js":
/*!***********************************!*\
  !*** ./pages/api/dex/trending.js ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n//\n// Uses global `fetch` (available in Next.js) â€” do not import node-fetch to avoid duplicate global definitions.\n// DexScreener proxy for trending tokens (single clean implementation)\n// - Uses global fetch (Next.js runtime)\n// - Supports query params: ?limit, ?sort (volume|gainers), ?chain\n// - Filters to requested chain (default: solana)\n// - Enriches token metadata from Solana tokenlist when available\n// - In-memory caching to reduce outbound requests during dev\nconst DEX_API = process.env.DEX_API_URL || \"https://api.dexscreener.com/latest/dex\";\nconst SOL_TOKENLIST = \"https://raw.githubusercontent.com/solana-labs/token-list/main/src/tokens/solana.tokenlist.json\";\nconst CACHE = {\n    responses: {},\n    tokenlist: null,\n    tokenlistTs: 0,\n    logoMap: null\n};\nconst CG_CACHE = {\n    list: null,\n    listTs: 0,\n    prices: {},\n    pricesTs: {}\n};\nCG_CACHE.meta = {};\nconst COINGECKO_LIST_TTL = 1000 * 60 * 60; // 1h\nconst COINGECKO_PRICE_TTL = 1000 * 30; // 30s\nasync function loadCoinGeckoList() {\n    const now = Date.now();\n    if (CG_CACHE.list && now - CG_CACHE.listTs < COINGECKO_LIST_TTL) return CG_CACHE.list;\n    try {\n        const r = await fetch(\"https://api.coingecko.com/api/v3/coins/list\");\n        if (!r.ok) return null;\n        const j = await r.json();\n        // create a map by symbol uppercase -> id (first match wins)\n        const map = {};\n        for (const c of j || []){\n            try {\n                const sym = String(c.symbol || \"\").toUpperCase();\n                if (!map[sym]) map[sym] = c.id;\n            } catch (e) {}\n        }\n        CG_CACHE.list = map;\n        CG_CACHE.listTs = Date.now();\n        return map;\n    } catch (e) {\n        return null;\n    }\n}\nasync function getPriceFromCoinGecko(symbol, contractAddress) {\n    try {\n        const now = Date.now();\n        const key = (contractAddress || symbol || \"\").toLowerCase();\n        if (CG_CACHE.prices[key] && now - (CG_CACHE.pricesTs[key] || 0) < COINGECKO_PRICE_TTL) return CG_CACHE.prices[key];\n        // Attempt contract lookup for solana if contractAddress provided\n        if (contractAddress) {\n            try {\n                const r = await fetch(`https://api.coingecko.com/api/v3/coins/solana/contract/${contractAddress}`);\n                if (r.ok) {\n                    const j = await r.json();\n                    const usd = j.market_data?.current_price?.usd ?? null;\n                    if (usd !== null) {\n                        CG_CACHE.prices[key] = usd;\n                        CG_CACHE.pricesTs[key] = Date.now();\n                        return usd;\n                    }\n                }\n            } catch (e) {}\n        }\n        // Fallback: symbol -> id -> simple/price\n        const list = await loadCoinGeckoList();\n        if (list && symbol) {\n            const id = list[String(symbol).toUpperCase()];\n            if (id) {\n                const r = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${encodeURIComponent(id)}&vs_currencies=usd`);\n                if (r.ok) {\n                    const j = await r.json();\n                    const usd = j[id]?.usd ?? null;\n                    if (usd !== null) {\n                        CG_CACHE.prices[key] = usd;\n                        CG_CACHE.pricesTs[key] = Date.now();\n                        return usd;\n                    }\n                }\n            }\n        }\n    } catch (e) {}\n    return null;\n}\n// Attempt to fetch authoritative token metadata (name/symbol) from CoinGecko\nasync function getCoinGeckoMeta(chain, contractAddress, fallbackSymbol) {\n    try {\n        const now = Date.now();\n        const key = `${chain}:${(contractAddress || \"\").toLowerCase()}`;\n        if (CG_CACHE.meta[key] && now - (CG_CACHE.meta[key].ts || 0) < 1000 * 60 * 10) {\n            return CG_CACHE.meta[key].data;\n        }\n        const platformMap = {\n            solana: \"solana\",\n            bsc: \"binance-smart-chain\",\n            bscscan: \"binance-smart-chain\",\n            ethereum: \"ethereum\",\n            polygon: \"polygon-pos\",\n            fantom: \"fantom\"\n        };\n        const platform = platformMap[chain] || chain;\n        // Try contract lookup (works for many supported platforms)\n        if (contractAddress) {\n            try {\n                const url = `https://api.coingecko.com/api/v3/coins/${encodeURIComponent(platform)}/contract/${encodeURIComponent(contractAddress)}`;\n                const r = await fetch(url);\n                if (r.ok) {\n                    const j = await r.json();\n                    const data = {\n                        name: j.name || null,\n                        symbol: j.symbol || null\n                    };\n                    CG_CACHE.meta[key] = {\n                        ts: Date.now(),\n                        data\n                    };\n                    return data;\n                }\n            } catch (e) {}\n        }\n        // Fallback: map by symbol -> id list and fetch simple coin data\n        const list = await loadCoinGeckoList();\n        if (list && fallbackSymbol) {\n            const id = list[String(fallbackSymbol).toUpperCase()];\n            if (id) {\n                try {\n                    const r2 = await fetch(`https://api.coingecko.com/api/v3/coins/${encodeURIComponent(id)}`);\n                    if (r2.ok) {\n                        const j2 = await r2.json();\n                        const data = {\n                            name: j2.name || null,\n                            symbol: j2.symbol || null\n                        };\n                        CG_CACHE.meta[key] = {\n                            ts: Date.now(),\n                            data\n                        };\n                        return data;\n                    }\n                } catch (e) {}\n            }\n        }\n        CG_CACHE.meta[key] = {\n            ts: Date.now(),\n            data: {\n                name: null,\n                symbol: null\n            }\n        };\n    } catch (e) {}\n    return {\n        name: null,\n        symbol: null\n    };\n}\nasync function loadTokenList() {\n    const now = Date.now();\n    if (CACHE.tokenlist && now - CACHE.tokenlistTs < 60000) return CACHE.tokenlist;\n    try {\n        const r = await fetch(SOL_TOKENLIST);\n        if (!r.ok) return null;\n        const j = await r.json();\n        const map = {};\n        for (const t of j.tokens || []){\n            try {\n                const key = String(t.address || \"\").toLowerCase();\n                if (key) map[key] = t;\n            } catch (e) {}\n        }\n        // build logo reverse-lookup map (filename or hash -> token meta)\n        const logoMap = {};\n        for (const t of j.tokens || []){\n            const maybe = t.logoURI || t.extensions?.logoURI || \"\";\n            if (!maybe) continue;\n            try {\n                const parts = String(maybe).split(\"/\");\n                let last = parts[parts.length - 1] || \"\";\n                // strip query\n                last = last.split(\"?\")[0] || last;\n                last = last.toLowerCase();\n                if (last) logoMap[last] = t;\n            } catch (e) {}\n        }\n        CACHE.tokenlist = map;\n        CACHE.logoMap = logoMap;\n        CACHE.tokenlistTs = Date.now();\n        return map;\n    } catch (err) {\n        return null;\n    }\n}\nasync function handler(req, res) {\n    try {\n        const { query } = req;\n        const limit = Math.min(Number(query.limit) || 100, 100);\n        const chain = (query.chain || \"solana\").toString().toLowerCase();\n        const sort = (query.sort || \"volume\").toString().toLowerCase();\n        const cacheKey = `${chain}:${sort}:${limit}`;\n        const now = Date.now();\n        if (CACHE.responses[cacheKey] && now - CACHE.responses[cacheKey].ts < 30000) {\n            return res.status(200).json({\n                data: CACHE.responses[cacheKey].data,\n                cached: true\n            });\n        }\n        // Try multiple upstream endpoints to be robust against DexScreener endpoint shapes.\n        const candidates = [\n            `${DEX_API}/${chain}`,\n            DEX_API,\n            \"https://api.dexscreener.com/token-boosts/top/v1\"\n        ];\n        let body = null;\n        let lastStatus = 0;\n        for (const url of candidates){\n            try {\n                const resp = await fetch(url, {\n                    headers: {\n                        \"User-Agent\": \"DopeWalletBot/1.0\"\n                    }\n                });\n                lastStatus = resp.status;\n                if (!resp.ok) {\n                    continue;\n                }\n                body = await resp.json();\n                break;\n            } catch (e) {\n                lastStatus = 500;\n                continue;\n            }\n        }\n        if (!body) return res.status(502).json({\n            error: \"DexScreener upstream error\",\n            status: lastStatus\n        });\n        // collect candidate pairs\n        let pairs = [];\n        if (Array.isArray(body)) pairs = body;\n        else if (Array.isArray(body.pairs)) pairs = body.pairs;\n        else {\n            for (const k of Object.keys(body || {})){\n                if (body[k]?.pairs && Array.isArray(body[k].pairs)) pairs = pairs.concat(body[k].pairs);\n            }\n        }\n        // Filter to requested chain by inspecting various hint fields\n        const filtered = (pairs || []).filter((p)=>{\n            const hints = [\n                p.chain,\n                p.chainId,\n                p.chainKey,\n                p.dex?.chain,\n                p.pair?.chain,\n                p.baseToken?.chain,\n                p.quoteToken?.chain\n            ].filter(Boolean).map(String).join(\" \").toLowerCase();\n            return hints.includes(chain);\n        });\n        // simple sorting\n        let sorted = filtered;\n        if (sort === \"volume\") sorted = filtered.sort((a, b)=>(Number(b.volume) || Number(b.volume_24h) || 0) - (Number(a.volume) || Number(a.volume_24h) || 0));\n        else if (sort === \"gainers\") sorted = filtered.sort((a, b)=>(Number(b.priceChange) || Number(b.change) || 0) - (Number(a.priceChange) || Number(a.change) || 0));\n        const tokenlist = await loadTokenList();\n        const rawSlice = (sorted || []).slice(0, limit);\n        const normalized = [];\n        // Build initial normalized entries (without async enrichment)\n        for (const it of rawSlice){\n            const address = it.tokenAddress || it.address || it.pairAddress || it.baseToken?.address || it.quoteToken?.address || it.id || \"\";\n            let logoURI = it.icon || it.logo || it.logoURI || it.tokenIcon || it.baseToken?.icon || it.quoteToken?.icon || \"\";\n            let symbol = it.symbol || it.tokenSymbol || it.token?.symbol || it.baseToken?.symbol || it.quoteToken?.symbol || it.name || \"\";\n            let name = it.name || it.tokenName || it.baseToken?.name || it.quoteToken?.name || \"\";\n            const lookupAddr = String(address || \"\").toLowerCase();\n            if ((!logoURI || !symbol) && tokenlist && lookupAddr && tokenlist[lookupAddr]) {\n                const meta = tokenlist[lookupAddr];\n                logoURI = logoURI || meta.logoURI || meta.extensions?.logoURI || \"\";\n                symbol = symbol || meta.symbol || meta.name || \"\";\n            }\n            // fallback: try logo filename/hash lookup from tokenlist (helps when upstream returns icon hash)\n            if ((!symbol || !logoURI) && CACHE.logoMap) {\n                try {\n                    let candidate = logoURI || \"\";\n                    // if candidate is short (a hash), use it; otherwise extract filename\n                    if (candidate && !candidate.startsWith(\"http\")) {\n                        candidate = String(candidate).toLowerCase();\n                    } else if (candidate.startsWith(\"http\")) {\n                        const parts = String(candidate).split(\"/\");\n                        candidate = (parts[parts.length - 1] || \"\").split(\"?\")[0].toLowerCase();\n                    }\n                    if (candidate && CACHE.logoMap[candidate]) {\n                        const m = CACHE.logoMap[candidate];\n                        logoURI = logoURI || m.logoURI || m.extensions?.logoURI || \"\";\n                        symbol = symbol || m.symbol || m.name || \"\";\n                    }\n                } catch (e) {}\n            }\n            const price = Number(it.priceUsd || it.price || it.tokenPrice || it.price_usd || it.baseToken?.price || 0) || 0;\n            const change24h = Number(it.priceChange || it.change || it.change_24h || it.price_change_percentage_24h || 0) || 0;\n            const volume24h = Number(it.volume || it.volume24h || it.volume_24h || it.quoteVolume || it.liquidity || 0) || 0;\n            if (!logoURI && address) logoURI = `https://cdn.dexscreener.com/token-images/${chain}/${address}`;\n            // Fallback name/symbol heuristics when upstream lacks them\n            const rawDesc = it.description || it.raw?.description || it.tokenDescription || \"\" || \"\";\n            const urlName = it.url || it.raw?.url || \"\" ? String(it.url || it.raw?.url).split(\"/\").filter(Boolean).pop() : \"\";\n            function guessFromText(text) {\n                if (!text) return \"\";\n                // prefer first token-like word\n                const cleaned = String(text).replace(/[\\n\\r]/g, \" \").trim();\n                const first = cleaned.split(/\\s|_|-|\\//).filter(Boolean)[0] || \"\";\n                const alpha = first.replace(/[^A-Za-z0-9]/g, \"\");\n                return alpha.toUpperCase().slice(0, 6);\n            }\n            const initialName = name || \"\";\n            const initialSymbol = symbol || \"\";\n            normalized.push({\n                address,\n                logoURI,\n                symbol: initialSymbol,\n                name: initialName,\n                price,\n                change24h,\n                volume24h,\n                raw: it\n            });\n        }\n        // Enrich entries with authoritative metadata from CoinGecko when possible (sequential to avoid API rate limits)\n        for (const entry of normalized){\n            try {\n                const lookupAddr = String(entry.address || \"\").toLowerCase();\n                let cgMeta = {\n                    name: null,\n                    symbol: null\n                };\n                // prefer tokenlist metadata already merged earlier (entry may have logoURI indicating tokenlist match)\n                if ((!entry.name || !entry.symbol) && lookupAddr && tokenlist && tokenlist[lookupAddr]) {\n                    const m = tokenlist[lookupAddr];\n                    if (m) {\n                        entry.name = entry.name || m.name || m.symbol || \"\";\n                        entry.symbol = entry.symbol || m.symbol || m.name || \"\";\n                        continue; // authoritative from tokenlist\n                    }\n                }\n                // Try CoinGecko contract lookup\n                if ((!entry.name || !entry.symbol) && entry.address) {\n                    cgMeta = await getCoinGeckoMeta(chain, entry.address, entry.symbol || entry.name);\n                    if (cgMeta) {\n                        if (cgMeta.name) entry.name = entry.name || cgMeta.name;\n                        if (cgMeta.symbol) entry.symbol = entry.symbol || cgMeta.symbol.toUpperCase();\n                        if (entry.name && entry.symbol) continue;\n                    }\n                }\n                // As a last resort, if still empty, use heuristics but keep them only if nothing authoritative found\n                if (!entry.symbol) entry.symbol = entry.name && entry.name.length <= 10 ? entry.name.toUpperCase().split(\" \")[0] : entry.address ? `${String(entry.address).slice(0, 4)}...` : \"\";\n                if (!entry.name) entry.name = entry.raw?.name || entry.raw?.tokenName || entry.raw?.description || \"\";\n            } catch (e) {\n            // ignore per-entry failures\n            }\n        }\n        CACHE.responses[cacheKey] = {\n            ts: Date.now(),\n            data: normalized\n        };\n        return res.status(200).json({\n            data: normalized,\n            cached: false\n        });\n    } catch (err) {\n        console.error(\"trending proxy error\", err);\n        return res.status(500).json({\n            error: String(err)\n        });\n    }\n} //\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUFBTXZHLElBQUksQ0FBQ2EsTUFBTSxJQUFJLEtBQU0wRixNQUFNdkcsSUFBSSxDQUFDekIsV0FBVyxHQUFHb0MsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFLEdBQUk0RixNQUFNakcsT0FBTyxHQUFHLENBQUMsRUFBRWpDLE9BQU9rSSxNQUFNakcsT0FBTyxFQUFFd0QsS0FBSyxDQUFDLEdBQUUsR0FBRyxHQUFHLENBQUMsR0FBRztnQkFDakwsSUFBSSxDQUFDeUMsTUFBTXZHLElBQUksRUFBRXVHLE1BQU12RyxJQUFJLEdBQUd1RyxNQUFNZCxHQUFHLEVBQUV6RixRQUFRdUcsTUFBTWQsR0FBRyxFQUFFakIsYUFBYStCLE1BQU1kLEdBQUcsRUFBRUQsZUFBZTtZQUNyRyxFQUFFLE9BQU8vRyxHQUFHO1lBQ1YsNEJBQTRCO1lBQzlCO1FBQ0o7UUFFRTVCLE1BQU1DLFNBQVMsQ0FBQzJFLFNBQVMsR0FBRztZQUFFcEMsSUFBSXpCLEtBQUtELEdBQUc7WUFBSTJCLE1BQU15RTtRQUFXO1FBQy9ELE9BQU85QyxJQUFJUyxNQUFNLENBQUMsS0FBS3pELElBQUksQ0FBQztZQUFFcUIsTUFBTXlFO1lBQVlwQyxRQUFRO1FBQU07SUFDaEUsRUFBRSxPQUFPYixLQUFLO1FBQ1oyRixRQUFReEUsS0FBSyxDQUFDLHdCQUF3Qm5CO1FBQ3RDLE9BQU9HLElBQUlTLE1BQU0sQ0FBQyxLQUFLekQsSUFBSSxDQUFDO1lBQUVnRSxPQUFPNUQsT0FBT3lDO1FBQUs7SUFDbkQ7QUFDRixFQUNBLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kb3Bld2FsbGV0LWZyb250ZW5kLy4vcGFnZXMvYXBpL2RleC90cmVuZGluZy5qcz8wM2RlIl0sInNvdXJjZXNDb250ZW50IjpbIi8vXG4vLyBVc2VzIGdsb2JhbCBgZmV0Y2hgIChhdmFpbGFibGUgaW4gTmV4dC5qcykg4oCUIGRvIG5vdCBpbXBvcnQgbm9kZS1mZXRjaCB0byBhdm9pZCBkdXBsaWNhdGUgZ2xvYmFsIGRlZmluaXRpb25zLlxuXG4vLyBEZXhTY3JlZW5lciBwcm94eSBmb3IgdHJlbmRpbmcgdG9rZW5zIChzaW5nbGUgY2xlYW4gaW1wbGVtZW50YXRpb24pXG4vLyAtIFVzZXMgZ2xvYmFsIGZldGNoIChOZXh0LmpzIHJ1bnRpbWUpXG4vLyAtIFN1cHBvcnRzIHF1ZXJ5IHBhcmFtczogP2xpbWl0LCA/c29ydCAodm9sdW1lfGdhaW5lcnMpLCA/Y2hhaW5cbi8vIC0gRmlsdGVycyB0byByZXF1ZXN0ZWQgY2hhaW4gKGRlZmF1bHQ6IHNvbGFuYSlcbi8vIC0gRW5yaWNoZXMgdG9rZW4gbWV0YWRhdGEgZnJvbSBTb2xhbmEgdG9rZW5saXN0IHdoZW4gYXZhaWxhYmxlXG4vLyAtIEluLW1lbW9yeSBjYWNoaW5nIHRvIHJlZHVjZSBvdXRib3VuZCByZXF1ZXN0cyBkdXJpbmcgZGV2XG5cbmNvbnN0IERFWF9BUEkgPSBwcm9jZXNzLmVudi5ERVhfQVBJX1VSTCB8fCAnaHR0cHM6Ly9hcGkuZGV4c2NyZWVuZXIuY29tL2xhdGVzdC9kZXgnO1xuY29uc3QgU09MX1RPS0VOTElTVCA9ICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vc29sYW5hLWxhYnMvdG9rZW4tbGlzdC9tYWluL3NyYy90b2tlbnMvc29sYW5hLnRva2VubGlzdC5qc29uJztcblxuY29uc3QgQ0FDSEUgPSB7IHJlc3BvbnNlczoge30sIHRva2VubGlzdDogbnVsbCwgdG9rZW5saXN0VHM6IDAsIGxvZ29NYXA6IG51bGwgfTtcbmNvbnN0IENHX0NBQ0hFID0geyBsaXN0OiBudWxsLCBsaXN0VHM6IDAsIHByaWNlczoge30sIHByaWNlc1RzOiB7fSB9O1xuQ0dfQ0FDSEUubWV0YSA9IHt9O1xuY29uc3QgQ09JTkdFQ0tPX0xJU1RfVFRMID0gMTAwMCAqIDYwICogNjA7IC8vIDFoXG5jb25zdCBDT0lOR0VDS09fUFJJQ0VfVFRMID0gMTAwMCAqIDMwOyAvLyAzMHNcblxuYXN5bmMgZnVuY3Rpb24gbG9hZENvaW5HZWNrb0xpc3QoKSB7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIGlmIChDR19DQUNIRS5saXN0ICYmIChub3cgLSBDR19DQUNIRS5saXN0VHMpIDwgQ09JTkdFQ0tPX0xJU1RfVFRMKSByZXR1cm4gQ0dfQ0FDSEUubGlzdDtcbiAgdHJ5IHtcbiAgICBjb25zdCByID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vYXBpLmNvaW5nZWNrby5jb20vYXBpL3YzL2NvaW5zL2xpc3QnKTtcbiAgICBpZiAoIXIub2spIHJldHVybiBudWxsO1xuICAgIGNvbnN0IGogPSBhd2FpdCByLmpzb24oKTtcbiAgICAvLyBjcmVhdGUgYSBtYXAgYnkgc3ltYm9sIHVwcGVyY2FzZSAtPiBpZCAoZmlyc3QgbWF0Y2ggd2lucylcbiAgICBjb25zdCBtYXAgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGMgb2YgaiB8fCBbXSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3Qgc3ltID0gU3RyaW5nKGMuc3ltYm9sIHx8ICcnKS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICBpZiAoIW1hcFtzeW1dKSBtYXBbc3ltXSA9IGMuaWQ7XG4gICAgICB9IGNhdGNoIChlKSB7fVxuICAgIH1cbiAgICBDR19DQUNIRS5saXN0ID0gbWFwO1xuICAgIENHX0NBQ0hFLmxpc3RUcyA9IERhdGUubm93KCk7XG4gICAgcmV0dXJuIG1hcDtcbiAgfSBjYXRjaCAoZSkgeyByZXR1cm4gbnVsbDsgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBnZXRQcmljZUZyb21Db2luR2Vja28oc3ltYm9sLCBjb250cmFjdEFkZHJlc3MpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IGtleSA9IChjb250cmFjdEFkZHJlc3MgfHwgc3ltYm9sIHx8ICcnKS50b0xvd2VyQ2FzZSgpO1xuICAgIGlmIChDR19DQUNIRS5wcmljZXNba2V5XSAmJiAobm93IC0gKENHX0NBQ0hFLnByaWNlc1RzW2tleV0gfHwgMCkpIDwgQ09JTkdFQ0tPX1BSSUNFX1RUTCkgcmV0dXJuIENHX0NBQ0hFLnByaWNlc1trZXldO1xuXG4gICAgLy8gQXR0ZW1wdCBjb250cmFjdCBsb29rdXAgZm9yIHNvbGFuYSBpZiBjb250cmFjdEFkZHJlc3MgcHJvdmlkZWRcbiAgICBpZiAoY29udHJhY3RBZGRyZXNzKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByID0gYXdhaXQgZmV0Y2goYGh0dHBzOi8vYXBpLmNvaW5nZWNrby5jb20vYXBpL3YzL2NvaW5zL3NvbGFuYS9jb250cmFjdC8ke2NvbnRyYWN0QWRkcmVzc31gKTtcbiAgICAgICAgaWYgKHIub2spIHtcbiAgICAgICAgICBjb25zdCBqID0gYXdhaXQgci5qc29uKCk7XG4gICAgICAgICAgY29uc3QgdXNkID0gai5tYXJrZXRfZGF0YT8uY3VycmVudF9wcmljZT8udXNkID8/IG51bGw7XG4gICAgICAgICAgaWYgKHVzZCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgQ0dfQ0FDSEUucHJpY2VzW2tleV0gPSB1c2Q7XG4gICAgICAgICAgICBDR19DQUNIRS5wcmljZXNUc1trZXldID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICAgIHJldHVybiB1c2Q7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7fVxuICAgIH1cblxuICAgIC8vIEZhbGxiYWNrOiBzeW1ib2wgLT4gaWQgLT4gc2ltcGxlL3ByaWNlXG4gICAgY29uc3QgbGlzdCA9IGF3YWl0IGxvYWRDb2luR2Vja29MaXN0KCk7XG4gICAgaWYgKGxpc3QgJiYgc3ltYm9sKSB7XG4gICAgICBjb25zdCBpZCA9IGxpc3RbU3RyaW5nKHN5bWJvbCkudG9VcHBlckNhc2UoKV07XG4gICAgICBpZiAoaWQpIHtcbiAgICAgICAgY29uc3QgciA9IGF3YWl0IGZldGNoKGBodHRwczovL2FwaS5jb2luZ2Vja28uY29tL2FwaS92My9zaW1wbGUvcHJpY2U/aWRzPSR7ZW5jb2RlVVJJQ29tcG9uZW50KGlkKX0mdnNfY3VycmVuY2llcz11c2RgKTtcbiAgICAgICAgaWYgKHIub2spIHtcbiAgICAgICAgICBjb25zdCBqID0gYXdhaXQgci5qc29uKCk7XG4gICAgICAgICAgY29uc3QgdXNkID0galtpZF0/LnVzZCA/PyBudWxsO1xuICAgICAgICAgIGlmICh1c2QgIT09IG51bGwpIHtcbiAgICAgICAgICAgIENHX0NBQ0hFLnByaWNlc1trZXldID0gdXNkO1xuICAgICAgICAgICAgQ0dfQ0FDSEUucHJpY2VzVHNba2V5XSA9IERhdGUubm93KCk7XG4gICAgICAgICAgICByZXR1cm4gdXNkO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSBjYXRjaCAoZSkgeyAvKiBpZ25vcmUgKi8gfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLy8gQXR0ZW1wdCB0byBmZXRjaCBhdXRob3JpdGF0aXZlIHRva2VuIG1ldGFkYXRhIChuYW1lL3N5bWJvbCkgZnJvbSBDb2luR2Vja29cbmFzeW5jIGZ1bmN0aW9uIGdldENvaW5HZWNrb01ldGEoY2hhaW4sIGNvbnRyYWN0QWRkcmVzcywgZmFsbGJhY2tTeW1ib2wpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IGtleSA9IGAke2NoYWlufTokeyhjb250cmFjdEFkZHJlc3N8fCcnKS50b0xvd2VyQ2FzZSgpfWA7XG4gICAgaWYgKENHX0NBQ0hFLm1ldGFba2V5XSAmJiAobm93IC0gKENHX0NBQ0hFLm1ldGFba2V5XS50cyB8fCAwKSkgPCAxMDAwICogNjAgKiAxMCkge1xuICAgICAgcmV0dXJuIENHX0NBQ0hFLm1ldGFba2V5XS5kYXRhO1xuICAgIH1cblxuICAgIGNvbnN0IHBsYXRmb3JtTWFwID0ge1xuICAgICAgc29sYW5hOiAnc29sYW5hJyxcbiAgICAgIGJzYzogJ2JpbmFuY2Utc21hcnQtY2hhaW4nLFxuICAgICAgYnNjc2NhbjogJ2JpbmFuY2Utc21hcnQtY2hhaW4nLFxuICAgICAgZXRoZXJldW06ICdldGhlcmV1bScsXG4gICAgICBwb2x5Z29uOiAncG9seWdvbi1wb3MnLFxuICAgICAgZmFudG9tOiAnZmFudG9tJyxcbiAgICB9O1xuICAgIGNvbnN0IHBsYXRmb3JtID0gcGxhdGZvcm1NYXBbY2hhaW5dIHx8IGNoYWluO1xuXG4gICAgLy8gVHJ5IGNvbnRyYWN0IGxvb2t1cCAod29ya3MgZm9yIG1hbnkgc3VwcG9ydGVkIHBsYXRmb3JtcylcbiAgICBpZiAoY29udHJhY3RBZGRyZXNzKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB1cmwgPSBgaHR0cHM6Ly9hcGkuY29pbmdlY2tvLmNvbS9hcGkvdjMvY29pbnMvJHtlbmNvZGVVUklDb21wb25lbnQocGxhdGZvcm0pfS9jb250cmFjdC8ke2VuY29kZVVSSUNvbXBvbmVudChjb250cmFjdEFkZHJlc3MpfWA7XG4gICAgICAgIGNvbnN0IHIgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICAgICAgICBpZiAoci5vaykge1xuICAgICAgICAgIGNvbnN0IGogPSBhd2FpdCByLmpzb24oKTtcbiAgICAgICAgICBjb25zdCBkYXRhID0geyBuYW1lOiBqLm5hbWUgfHwgbnVsbCwgc3ltYm9sOiBqLnN5bWJvbCB8fCBudWxsIH07XG4gICAgICAgICAgQ0dfQ0FDSEUubWV0YVtrZXldID0geyB0czogRGF0ZS5ub3coKSwgZGF0YSB9O1xuICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7IC8qIGlnbm9yZSBjb250cmFjdCBsb29rdXAgZXJyb3JzICovIH1cbiAgICB9XG5cbiAgICAvLyBGYWxsYmFjazogbWFwIGJ5IHN5bWJvbCAtPiBpZCBsaXN0IGFuZCBmZXRjaCBzaW1wbGUgY29pbiBkYXRhXG4gICAgY29uc3QgbGlzdCA9IGF3YWl0IGxvYWRDb2luR2Vja29MaXN0KCk7XG4gICAgaWYgKGxpc3QgJiYgZmFsbGJhY2tTeW1ib2wpIHtcbiAgICAgIGNvbnN0IGlkID0gbGlzdFtTdHJpbmcoZmFsbGJhY2tTeW1ib2wpLnRvVXBwZXJDYXNlKCldO1xuICAgICAgaWYgKGlkKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgcjIgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly9hcGkuY29pbmdlY2tvLmNvbS9hcGkvdjMvY29pbnMvJHtlbmNvZGVVUklDb21wb25lbnQoaWQpfWApO1xuICAgICAgICAgIGlmIChyMi5vaykge1xuICAgICAgICAgICAgY29uc3QgajIgPSBhd2FpdCByMi5qc29uKCk7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0geyBuYW1lOiBqMi5uYW1lIHx8IG51bGwsIHN5bWJvbDogajIuc3ltYm9sIHx8IG51bGwgfTtcbiAgICAgICAgICAgIENHX0NBQ0hFLm1ldGFba2V5XSA9IHsgdHM6IERhdGUubm93KCksIGRhdGEgfTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkgeyAvKiBpZ25vcmUgKi8gfVxuICAgICAgfVxuICAgIH1cblxuICAgIENHX0NBQ0hFLm1ldGFba2V5XSA9IHsgdHM6IERhdGUubm93KCksIGRhdGE6IHsgbmFtZTogbnVsbCwgc3ltYm9sOiBudWxsIH0gfTtcbiAgfSBjYXRjaCAoZSkgeyAvKiBpZ25vcmUgKi8gfVxuICByZXR1cm4geyBuYW1lOiBudWxsLCBzeW1ib2w6IG51bGwgfTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gbG9hZFRva2VuTGlzdCgpIHtcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgaWYgKENBQ0hFLnRva2VubGlzdCAmJiAobm93IC0gQ0FDSEUudG9rZW5saXN0VHMpIDwgNjBfMDAwKSByZXR1cm4gQ0FDSEUudG9rZW5saXN0O1xuICB0cnkge1xuICAgIGNvbnN0IHIgPSBhd2FpdCBmZXRjaChTT0xfVE9LRU5MSVNUKTtcbiAgICBpZiAoIXIub2spIHJldHVybiBudWxsO1xuICAgIGNvbnN0IGogPSBhd2FpdCByLmpzb24oKTtcbiAgICBjb25zdCBtYXAgPSB7fTtcbiAgICBmb3IgKGNvbnN0IHQgb2YgKGoudG9rZW5zIHx8IFtdKSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3Qga2V5ID0gU3RyaW5nKHQuYWRkcmVzcyB8fCAnJykudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgaWYgKGtleSkgbWFwW2tleV0gPSB0O1xuICAgICAgfSBjYXRjaCAoZSkgeyAvKiBpZ25vcmUgKi8gfVxuICAgIH1cbiAgICAvLyBidWlsZCBsb2dvIHJldmVyc2UtbG9va3VwIG1hcCAoZmlsZW5hbWUgb3IgaGFzaCAtPiB0b2tlbiBtZXRhKVxuICAgIGNvbnN0IGxvZ29NYXAgPSB7fTtcbiAgICBmb3IgKGNvbnN0IHQgb2YgKGoudG9rZW5zIHx8IFtdKSkge1xuICAgICAgY29uc3QgbWF5YmUgPSB0LmxvZ29VUkkgfHwgdC5leHRlbnNpb25zPy5sb2dvVVJJIHx8ICcnO1xuICAgICAgaWYgKCFtYXliZSkgY29udGludWU7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBwYXJ0cyA9IFN0cmluZyhtYXliZSkuc3BsaXQoJy8nKTtcbiAgICAgICAgbGV0IGxhc3QgPSBwYXJ0c1twYXJ0cy5sZW5ndGgtMV0gfHwgJyc7XG4gICAgICAgIC8vIHN0cmlwIHF1ZXJ5XG4gICAgICAgIGxhc3QgPSBsYXN0LnNwbGl0KCc/JylbMF0gfHwgbGFzdDtcbiAgICAgICAgbGFzdCA9IGxhc3QudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgaWYgKGxhc3QpIGxvZ29NYXBbbGFzdF0gPSB0O1xuICAgICAgfSBjYXRjaCAoZSkgeyAvKiBpZ25vcmUgKi8gfVxuICAgIH1cbiAgICAgIENBQ0hFLnRva2VubGlzdCA9IG1hcDtcbiAgICBDQUNIRS5sb2dvTWFwID0gbG9nb01hcDtcbiAgICBDQUNIRS50b2tlbmxpc3RUcyA9IERhdGUubm93KCk7XG4gICAgcmV0dXJuIG1hcDtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcXVlcnkgfSA9IHJlcTtcbiAgICBjb25zdCBsaW1pdCA9IE1hdGgubWluKE51bWJlcihxdWVyeS5saW1pdCkgfHwgMTAwLCAxMDApO1xuICAgIGNvbnN0IGNoYWluID0gKHF1ZXJ5LmNoYWluIHx8ICdzb2xhbmEnKS50b1N0cmluZygpLnRvTG93ZXJDYXNlKCk7XG4gICAgY29uc3Qgc29ydCA9IChxdWVyeS5zb3J0IHx8ICd2b2x1bWUnKS50b1N0cmluZygpLnRvTG93ZXJDYXNlKCk7XG5cbiAgICBjb25zdCBjYWNoZUtleSA9IGAke2NoYWlufToke3NvcnR9OiR7bGltaXR9YDtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGlmIChDQUNIRS5yZXNwb25zZXNbY2FjaGVLZXldICYmIChub3cgLSBDQUNIRS5yZXNwb25zZXNbY2FjaGVLZXldLnRzKSA8IDMwXzAwMCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgZGF0YTogQ0FDSEUucmVzcG9uc2VzW2NhY2hlS2V5XS5kYXRhLCBjYWNoZWQ6IHRydWUgfSk7XG4gICAgfVxuXG4gICAgLy8gVHJ5IG11bHRpcGxlIHVwc3RyZWFtIGVuZHBvaW50cyB0byBiZSByb2J1c3QgYWdhaW5zdCBEZXhTY3JlZW5lciBlbmRwb2ludCBzaGFwZXMuXG4gICAgY29uc3QgY2FuZGlkYXRlcyA9IFtcbiAgICAgIGAke0RFWF9BUEl9LyR7Y2hhaW59YCwgLy8gY2hhaW4tc3BlY2lmaWMgKGUuZy4gL2xhdGVzdC9kZXgvc29sYW5hKVxuICAgICAgREVYX0FQSSwgLy8gZ2xvYmFsXG4gICAgICAnaHR0cHM6Ly9hcGkuZGV4c2NyZWVuZXIuY29tL3Rva2VuLWJvb3N0cy90b3AvdjEnLCAvLyBhbHRlcm5hdGl2ZSAvdG9rZW4tYm9vc3RzIGVuZHBvaW50XG4gICAgXTtcblxuICAgIGxldCBib2R5ID0gbnVsbDtcbiAgICBsZXQgbGFzdFN0YXR1cyA9IDA7XG4gICAgZm9yIChjb25zdCB1cmwgb2YgY2FuZGlkYXRlcykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcCA9IGF3YWl0IGZldGNoKHVybCwgeyBoZWFkZXJzOiB7ICdVc2VyLUFnZW50JzogJ0RvcGVXYWxsZXRCb3QvMS4wJyB9IH0pO1xuICAgICAgICBsYXN0U3RhdHVzID0gcmVzcC5zdGF0dXM7XG4gICAgICAgIGlmICghcmVzcC5vaykge1xuICAgICAgICAgIC8vIGtlZXAgdHJ5aW5nIG90aGVyIGNhbmRpZGF0ZXNcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBib2R5ID0gYXdhaXQgcmVzcC5qc29uKCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsYXN0U3RhdHVzID0gNTAwO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIWJvZHkpIHJldHVybiByZXMuc3RhdHVzKDUwMikuanNvbih7IGVycm9yOiAnRGV4U2NyZWVuZXIgdXBzdHJlYW0gZXJyb3InLCBzdGF0dXM6IGxhc3RTdGF0dXMgfSk7XG5cbiAgICAvLyBjb2xsZWN0IGNhbmRpZGF0ZSBwYWlyc1xuICAgIGxldCBwYWlycyA9IFtdO1xuICAgIGlmIChBcnJheS5pc0FycmF5KGJvZHkpKSBwYWlycyA9IGJvZHk7XG4gICAgZWxzZSBpZiAoQXJyYXkuaXNBcnJheShib2R5LnBhaXJzKSkgcGFpcnMgPSBib2R5LnBhaXJzO1xuICAgIGVsc2Uge1xuICAgICAgZm9yIChjb25zdCBrIG9mIE9iamVjdC5rZXlzKGJvZHkgfHwge30pKSB7XG4gICAgICAgIGlmIChib2R5W2tdPy5wYWlycyAmJiBBcnJheS5pc0FycmF5KGJvZHlba10ucGFpcnMpKSBwYWlycyA9IHBhaXJzLmNvbmNhdChib2R5W2tdLnBhaXJzKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBGaWx0ZXIgdG8gcmVxdWVzdGVkIGNoYWluIGJ5IGluc3BlY3RpbmcgdmFyaW91cyBoaW50IGZpZWxkc1xuICAgIGNvbnN0IGZpbHRlcmVkID0gKHBhaXJzIHx8IFtdKS5maWx0ZXIocCA9PiB7XG4gICAgICBjb25zdCBoaW50cyA9IFtwLmNoYWluLCBwLmNoYWluSWQsIHAuY2hhaW5LZXksIHAuZGV4Py5jaGFpbiwgcC5wYWlyPy5jaGFpbiwgcC5iYXNlVG9rZW4/LmNoYWluLCBwLnF1b3RlVG9rZW4/LmNoYWluXVxuICAgICAgICAuZmlsdGVyKEJvb2xlYW4pLm1hcChTdHJpbmcpLmpvaW4oJyAnKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgcmV0dXJuIGhpbnRzLmluY2x1ZGVzKGNoYWluKTtcbiAgICB9KTtcblxuICAgIC8vIHNpbXBsZSBzb3J0aW5nXG4gICAgbGV0IHNvcnRlZCA9IGZpbHRlcmVkO1xuICAgIGlmIChzb3J0ID09PSAndm9sdW1lJykgc29ydGVkID0gZmlsdGVyZWQuc29ydCgoYSxiKT0+IChOdW1iZXIoYi52b2x1bWUpIHx8IE51bWJlcihiLnZvbHVtZV8yNGgpIHx8IDApIC0gKE51bWJlcihhLnZvbHVtZSkgfHwgTnVtYmVyKGEudm9sdW1lXzI0aCkgfHwgMCkpO1xuICAgIGVsc2UgaWYgKHNvcnQgPT09ICdnYWluZXJzJykgc29ydGVkID0gZmlsdGVyZWQuc29ydCgoYSxiKT0+IChOdW1iZXIoYi5wcmljZUNoYW5nZSkgfHwgTnVtYmVyKGIuY2hhbmdlKSB8fCAwKSAtIChOdW1iZXIoYS5wcmljZUNoYW5nZSkgfHwgTnVtYmVyKGEuY2hhbmdlKSB8fCAwKSk7XG5cbiAgICBjb25zdCB0b2tlbmxpc3QgPSBhd2FpdCBsb2FkVG9rZW5MaXN0KCk7XG5cbiAgICBjb25zdCByYXdTbGljZSA9IChzb3J0ZWQgfHwgW10pLnNsaWNlKDAsIGxpbWl0KTtcbiAgICBjb25zdCBub3JtYWxpemVkID0gW107XG4gICAgLy8gQnVpbGQgaW5pdGlhbCBub3JtYWxpemVkIGVudHJpZXMgKHdpdGhvdXQgYXN5bmMgZW5yaWNobWVudClcbiAgICBmb3IgKGNvbnN0IGl0IG9mIHJhd1NsaWNlKSB7XG4gICAgICBjb25zdCBhZGRyZXNzID0gaXQudG9rZW5BZGRyZXNzIHx8IGl0LmFkZHJlc3MgfHwgaXQucGFpckFkZHJlc3MgfHwgaXQuYmFzZVRva2VuPy5hZGRyZXNzIHx8IGl0LnF1b3RlVG9rZW4/LmFkZHJlc3MgfHwgaXQuaWQgfHwgJyc7XG4gICAgICBsZXQgbG9nb1VSSSA9IGl0Lmljb24gfHwgaXQubG9nbyB8fCBpdC5sb2dvVVJJIHx8IGl0LnRva2VuSWNvbiB8fCBpdC5iYXNlVG9rZW4/Lmljb24gfHwgaXQucXVvdGVUb2tlbj8uaWNvbiB8fCAnJztcbiAgICAgIGxldCBzeW1ib2wgPSBpdC5zeW1ib2wgfHwgaXQudG9rZW5TeW1ib2wgfHwgaXQudG9rZW4/LnN5bWJvbCB8fCBpdC5iYXNlVG9rZW4/LnN5bWJvbCB8fCBpdC5xdW90ZVRva2VuPy5zeW1ib2wgfHwgaXQubmFtZSB8fCAnJztcbiAgICAgIGxldCBuYW1lID0gaXQubmFtZSB8fCBpdC50b2tlbk5hbWUgfHwgaXQuYmFzZVRva2VuPy5uYW1lIHx8IGl0LnF1b3RlVG9rZW4/Lm5hbWUgfHwgJyc7XG5cbiAgICAgIGNvbnN0IGxvb2t1cEFkZHIgPSBTdHJpbmcoYWRkcmVzcyB8fCAnJykudG9Mb3dlckNhc2UoKTtcbiAgICAgIGlmICgoIWxvZ29VUkkgfHwgIXN5bWJvbCkgJiYgdG9rZW5saXN0ICYmIGxvb2t1cEFkZHIgJiYgdG9rZW5saXN0W2xvb2t1cEFkZHJdKSB7XG4gICAgICAgIGNvbnN0IG1ldGEgPSB0b2tlbmxpc3RbbG9va3VwQWRkcl07XG4gICAgICAgIGxvZ29VUkkgPSBsb2dvVVJJIHx8IG1ldGEubG9nb1VSSSB8fCBtZXRhLmV4dGVuc2lvbnM/LmxvZ29VUkkgfHwgJyc7XG4gICAgICAgIHN5bWJvbCA9IHN5bWJvbCB8fCBtZXRhLnN5bWJvbCB8fCBtZXRhLm5hbWUgfHwgJyc7XG4gICAgICB9XG4gICAgICAvLyBmYWxsYmFjazogdHJ5IGxvZ28gZmlsZW5hbWUvaGFzaCBsb29rdXAgZnJvbSB0b2tlbmxpc3QgKGhlbHBzIHdoZW4gdXBzdHJlYW0gcmV0dXJucyBpY29uIGhhc2gpXG4gICAgICBpZiAoKCFzeW1ib2wgfHwgIWxvZ29VUkkpICYmIENBQ0hFLmxvZ29NYXApIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBsZXQgY2FuZGlkYXRlID0gbG9nb1VSSSB8fCAnJztcbiAgICAgICAgICAvLyBpZiBjYW5kaWRhdGUgaXMgc2hvcnQgKGEgaGFzaCksIHVzZSBpdDsgb3RoZXJ3aXNlIGV4dHJhY3QgZmlsZW5hbWVcbiAgICAgICAgICBpZiAoY2FuZGlkYXRlICYmICFjYW5kaWRhdGUuc3RhcnRzV2l0aCgnaHR0cCcpKSB7XG4gICAgICAgICAgICBjYW5kaWRhdGUgPSBTdHJpbmcoY2FuZGlkYXRlKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoY2FuZGlkYXRlLnN0YXJ0c1dpdGgoJ2h0dHAnKSkge1xuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBTdHJpbmcoY2FuZGlkYXRlKS5zcGxpdCgnLycpO1xuICAgICAgICAgICAgY2FuZGlkYXRlID0gKHBhcnRzW3BhcnRzLmxlbmd0aC0xXSB8fCAnJykuc3BsaXQoJz8nKVswXS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY2FuZGlkYXRlICYmIENBQ0hFLmxvZ29NYXBbY2FuZGlkYXRlXSkge1xuICAgICAgICAgICAgY29uc3QgbSA9IENBQ0hFLmxvZ29NYXBbY2FuZGlkYXRlXTtcbiAgICAgICAgICAgIGxvZ29VUkkgPSBsb2dvVVJJIHx8IG0ubG9nb1VSSSB8fCBtLmV4dGVuc2lvbnM/LmxvZ29VUkkgfHwgJyc7XG4gICAgICAgICAgICBzeW1ib2wgPSBzeW1ib2wgfHwgbS5zeW1ib2wgfHwgbS5uYW1lIHx8ICcnO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkgeyAvKiBpZ25vcmUgKi8gfVxuICAgICAgfVxuXG4gIGNvbnN0IHByaWNlID0gTnVtYmVyKGl0LnByaWNlVXNkIHx8IGl0LnByaWNlIHx8IGl0LnRva2VuUHJpY2UgfHwgaXQucHJpY2VfdXNkIHx8IGl0LmJhc2VUb2tlbj8ucHJpY2UgfHwgMCkgfHwgMDtcbiAgICAgIGNvbnN0IGNoYW5nZTI0aCA9IE51bWJlcihpdC5wcmljZUNoYW5nZSB8fCBpdC5jaGFuZ2UgfHwgaXQuY2hhbmdlXzI0aCB8fCBpdC5wcmljZV9jaGFuZ2VfcGVyY2VudGFnZV8yNGggfHwgMCkgfHwgMDtcbiAgICAgIGNvbnN0IHZvbHVtZTI0aCA9IE51bWJlcihpdC52b2x1bWUgfHwgaXQudm9sdW1lMjRoIHx8IGl0LnZvbHVtZV8yNGggfHwgaXQucXVvdGVWb2x1bWUgfHwgaXQubGlxdWlkaXR5IHx8IDApIHx8IDA7XG5cbiAgICAgIGlmICghbG9nb1VSSSAmJiBhZGRyZXNzKSBsb2dvVVJJID0gYGh0dHBzOi8vY2RuLmRleHNjcmVlbmVyLmNvbS90b2tlbi1pbWFnZXMvJHtjaGFpbn0vJHthZGRyZXNzfWA7XG5cbiAgICAgIC8vIEZhbGxiYWNrIG5hbWUvc3ltYm9sIGhldXJpc3RpY3Mgd2hlbiB1cHN0cmVhbSBsYWNrcyB0aGVtXG4gICAgICBjb25zdCByYXdEZXNjID0gKGl0LmRlc2NyaXB0aW9uIHx8IGl0LnJhdz8uZGVzY3JpcHRpb24gfHwgaXQudG9rZW5EZXNjcmlwdGlvbiB8fCAnJykgfHwgJyc7XG4gICAgICBjb25zdCB1cmxOYW1lID0gKGl0LnVybCB8fCBpdC5yYXc/LnVybCB8fCAnJykgPyBTdHJpbmcoaXQudXJsIHx8IGl0LnJhdz8udXJsKS5zcGxpdCgnLycpLmZpbHRlcihCb29sZWFuKS5wb3AoKSA6ICcnO1xuXG4gICAgICBmdW5jdGlvbiBndWVzc0Zyb21UZXh0KHRleHQpIHtcbiAgICAgICAgaWYgKCF0ZXh0KSByZXR1cm4gJyc7XG4gICAgICAgIC8vIHByZWZlciBmaXJzdCB0b2tlbi1saWtlIHdvcmRcbiAgICAgICAgY29uc3QgY2xlYW5lZCA9IFN0cmluZyh0ZXh0KS5yZXBsYWNlKC9bXFxuXFxyXS9nLCAnICcpLnRyaW0oKTtcbiAgICAgICAgY29uc3QgZmlyc3QgPSBjbGVhbmVkLnNwbGl0KC9cXHN8X3wtfFxcLy8pLmZpbHRlcihCb29sZWFuKVswXSB8fCAnJztcbiAgICAgICAgY29uc3QgYWxwaGEgPSBmaXJzdC5yZXBsYWNlKC9bXkEtWmEtejAtOV0vZywgJycpO1xuICAgICAgICByZXR1cm4gYWxwaGEudG9VcHBlckNhc2UoKS5zbGljZSgwLCA2KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgaW5pdGlhbE5hbWUgPSBuYW1lIHx8ICcnO1xuICAgICAgY29uc3QgaW5pdGlhbFN5bWJvbCA9IHN5bWJvbCB8fCAnJztcblxuICAgICAgbm9ybWFsaXplZC5wdXNoKHsgYWRkcmVzcywgbG9nb1VSSSwgc3ltYm9sOiBpbml0aWFsU3ltYm9sLCBuYW1lOiBpbml0aWFsTmFtZSwgcHJpY2UsIGNoYW5nZTI0aCwgdm9sdW1lMjRoLCByYXc6IGl0IH0pO1xuICAgIH1cblxuICAgIC8vIEVucmljaCBlbnRyaWVzIHdpdGggYXV0aG9yaXRhdGl2ZSBtZXRhZGF0YSBmcm9tIENvaW5HZWNrbyB3aGVuIHBvc3NpYmxlIChzZXF1ZW50aWFsIHRvIGF2b2lkIEFQSSByYXRlIGxpbWl0cylcbiAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIG5vcm1hbGl6ZWQpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGxvb2t1cEFkZHIgPSBTdHJpbmcoZW50cnkuYWRkcmVzcyB8fCAnJykudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgbGV0IGNnTWV0YSA9IHsgbmFtZTogbnVsbCwgc3ltYm9sOiBudWxsIH07XG5cbiAgICAgICAgLy8gcHJlZmVyIHRva2VubGlzdCBtZXRhZGF0YSBhbHJlYWR5IG1lcmdlZCBlYXJsaWVyIChlbnRyeSBtYXkgaGF2ZSBsb2dvVVJJIGluZGljYXRpbmcgdG9rZW5saXN0IG1hdGNoKVxuICAgICAgICBpZiAoKCFlbnRyeS5uYW1lIHx8ICFlbnRyeS5zeW1ib2wpICYmIGxvb2t1cEFkZHIgJiYgdG9rZW5saXN0ICYmIHRva2VubGlzdFtsb29rdXBBZGRyXSkge1xuICAgICAgICAgIGNvbnN0IG0gPSB0b2tlbmxpc3RbbG9va3VwQWRkcl07XG4gICAgICAgICAgaWYgKG0pIHtcbiAgICAgICAgICAgIGVudHJ5Lm5hbWUgPSBlbnRyeS5uYW1lIHx8IG0ubmFtZSB8fCBtLnN5bWJvbCB8fCAnJztcbiAgICAgICAgICAgIGVudHJ5LnN5bWJvbCA9IGVudHJ5LnN5bWJvbCB8fCBtLnN5bWJvbCB8fCBtLm5hbWUgfHwgJyc7XG4gICAgICAgICAgICBjb250aW51ZTsgLy8gYXV0aG9yaXRhdGl2ZSBmcm9tIHRva2VubGlzdFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRyeSBDb2luR2Vja28gY29udHJhY3QgbG9va3VwXG4gICAgICAgIGlmICgoIWVudHJ5Lm5hbWUgfHwgIWVudHJ5LnN5bWJvbCkgJiYgZW50cnkuYWRkcmVzcykge1xuICAgICAgICAgIGNnTWV0YSA9IGF3YWl0IGdldENvaW5HZWNrb01ldGEoY2hhaW4sIGVudHJ5LmFkZHJlc3MsIGVudHJ5LnN5bWJvbCB8fCBlbnRyeS5uYW1lKTtcbiAgICAgICAgICBpZiAoY2dNZXRhKSB7XG4gICAgICAgICAgICBpZiAoY2dNZXRhLm5hbWUpIGVudHJ5Lm5hbWUgPSBlbnRyeS5uYW1lIHx8IGNnTWV0YS5uYW1lO1xuICAgICAgICAgICAgaWYgKGNnTWV0YS5zeW1ib2wpIGVudHJ5LnN5bWJvbCA9IGVudHJ5LnN5bWJvbCB8fCBjZ01ldGEuc3ltYm9sLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICBpZiAoZW50cnkubmFtZSAmJiBlbnRyeS5zeW1ib2wpIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFzIGEgbGFzdCByZXNvcnQsIGlmIHN0aWxsIGVtcHR5LCB1c2UgaGV1cmlzdGljcyBidXQga2VlcCB0aGVtIG9ubHkgaWYgbm90aGluZyBhdXRob3JpdGF0aXZlIGZvdW5kXG4gICAgICAgIGlmICghZW50cnkuc3ltYm9sKSBlbnRyeS5zeW1ib2wgPSAoZW50cnkubmFtZSAmJiBlbnRyeS5uYW1lLmxlbmd0aCA8PSAxMCkgPyBlbnRyeS5uYW1lLnRvVXBwZXJDYXNlKCkuc3BsaXQoJyAnKVswXSA6IChlbnRyeS5hZGRyZXNzID8gYCR7U3RyaW5nKGVudHJ5LmFkZHJlc3MpLnNsaWNlKDAsNCl9Li4uYCA6ICcnKTtcbiAgICAgICAgaWYgKCFlbnRyeS5uYW1lKSBlbnRyeS5uYW1lID0gZW50cnkucmF3Py5uYW1lIHx8IGVudHJ5LnJhdz8udG9rZW5OYW1lIHx8IGVudHJ5LnJhdz8uZGVzY3JpcHRpb24gfHwgJyc7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIC8vIGlnbm9yZSBwZXItZW50cnkgZmFpbHVyZXNcbiAgICAgIH1cbiAgfVxuXG4gICAgQ0FDSEUucmVzcG9uc2VzW2NhY2hlS2V5XSA9IHsgdHM6IERhdGUubm93KCksIGRhdGE6IG5vcm1hbGl6ZWQgfTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oeyBkYXRhOiBub3JtYWxpemVkLCBjYWNoZWQ6IGZhbHNlIH0pO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBjb25zb2xlLmVycm9yKCd0cmVuZGluZyBwcm94eSBlcnJvcicsIGVycik7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IFN0cmluZyhlcnIpIH0pO1xuICB9XG59XG4vL1xuXG4iXSwibmFtZXMiOlsiREVYX0FQSSIsInByb2Nlc3MiLCJlbnYiLCJERVhfQVBJX1VSTCIsIlNPTF9UT0tFTkxJU1QiLCJDQUNIRSIsInJlc3BvbnNlcyIsInRva2VubGlzdCIsInRva2VubGlzdFRzIiwibG9nb01hcCIsIkNHX0NBQ0hFIiwibGlzdCIsImxpc3RUcyIsInByaWNlcyIsInByaWNlc1RzIiwibWV0YSIsIkNPSU5HRUNLT19MSVNUX1RUTCIsIkNPSU5HRUNLT19QUklDRV9UVEwiLCJsb2FkQ29pbkdlY2tvTGlzdCIsIm5vdyIsIkRhdGUiLCJyIiwiZmV0Y2giLCJvayIsImoiLCJqc29uIiwibWFwIiwiYyIsInN5bSIsIlN0cmluZyIsInN5bWJvbCIsInRvVXBwZXJDYXNlIiwiaWQiLCJlIiwiZ2V0UHJpY2VGcm9tQ29pbkdlY2tvIiwiY29udHJhY3RBZGRyZXNzIiwia2V5IiwidG9Mb3dlckNhc2UiLCJ1c2QiLCJtYXJrZXRfZGF0YSIsImN1cnJlbnRfcHJpY2UiLCJlbmNvZGVVUklDb21wb25lbnQiLCJnZXRDb2luR2Vja29NZXRhIiwiY2hhaW4iLCJmYWxsYmFja1N5bWJvbCIsInRzIiwiZGF0YSIsInBsYXRmb3JtTWFwIiwic29sYW5hIiwiYnNjIiwiYnNjc2NhbiIsImV0aGVyZXVtIiwicG9seWdvbiIsImZhbnRvbSIsInBsYXRmb3JtIiwidXJsIiwibmFtZSIsInIyIiwiajIiLCJsb2FkVG9rZW5MaXN0IiwidCIsInRva2VucyIsImFkZHJlc3MiLCJtYXliZSIsImxvZ29VUkkiLCJleHRlbnNpb25zIiwicGFydHMiLCJzcGxpdCIsImxhc3QiLCJsZW5ndGgiLCJlcnIiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwicXVlcnkiLCJsaW1pdCIsIk1hdGgiLCJtaW4iLCJOdW1iZXIiLCJ0b1N0cmluZyIsInNvcnQiLCJjYWNoZUtleSIsInN0YXR1cyIsImNhY2hlZCIsImNhbmRpZGF0ZXMiLCJib2R5IiwibGFzdFN0YXR1cyIsInJlc3AiLCJoZWFkZXJzIiwiZXJyb3IiLCJwYWlycyIsIkFycmF5IiwiaXNBcnJheSIsImsiLCJPYmplY3QiLCJrZXlzIiwiY29uY2F0IiwiZmlsdGVyZWQiLCJmaWx0ZXIiLCJwIiwiaGludHMiLCJjaGFpbklkIiwiY2hhaW5LZXkiLCJkZXgiLCJwYWlyIiwiYmFzZVRva2VuIiwicXVvdGVUb2tlbiIsIkJvb2xlYW4iLCJqb2luIiwiaW5jbHVkZXMiLCJzb3J0ZWQiLCJhIiwiYiIsInZvbHVtZSIsInZvbHVtZV8yNGgiLCJwcmljZUNoYW5nZSIsImNoYW5nZSIsInJhd1NsaWNlIiwic2xpY2UiLCJub3JtYWxpemVkIiwiaXQiLCJ0b2tlbkFkZHJlc3MiLCJwYWlyQWRkcmVzcyIsImljb24iLCJsb2dvIiwidG9rZW5JY29uIiwidG9rZW5TeW1ib2wiLCJ0b2tlbiIsInRva2VuTmFtZSIsImxvb2t1cEFkZHIiLCJjYW5kaWRhdGUiLCJzdGFydHNXaXRoIiwibSIsInByaWNlIiwicHJpY2VVc2QiLCJ0b2tlblByaWNlIiwicHJpY2VfdXNkIiwiY2hhbmdlMjRoIiwiY2hhbmdlXzI0aCIsInByaWNlX2NoYW5nZV9wZXJjZW50YWdlXzI0aCIsInZvbHVtZTI0aCIsInF1b3RlVm9sdW1lIiwibGlxdWlkaXR5IiwicmF3RGVzYyIsImRlc2NyaXB0aW9uIiwicmF3IiwidG9rZW5EZXNjcmlwdGlvbiIsInVybE5hbWUiLCJwb3AiLCJndWVzc0Zyb21UZXh0IiwidGV4dCIsImNsZWFuZWQiLCJyZXBsYWNlIiwidHJpbSIsImZpcnN0IiwiYWxwaGEiLCJpbml0aWFsTmFtZSIsImluaXRpYWxTeW1ib2wiLCJwdXNoIiwiZW50cnkiLCJjZ01ldGEiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/dex/trending.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdex%2Ftrending&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fdex%2Ftrending.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();