(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[910],{139:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/backup",function(){return n(933)}])},6469:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var s=n(5893),a=n(7294),i=n(1163),r=n(7066),l=n(1664),c=n.n(l),o=n(1526),d=n(3495);function u(e){let{onClose:t}=e;return(0,s.jsx)(o.M,{children:(0,s.jsx)(d.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/60 flex flex-col justify-end",onClick:t,children:(0,s.jsxs)(d.E.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{duration:.28},className:"bg-[#111] rounded-t-2xl text-white p-4 space-y-2",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("div",{className:"w-16 h-1 bg-[#333] rounded-full mx-auto mb-3"}),(0,s.jsx)("h3",{className:"text-center text-sm font-semibold text-textDim mb-2",children:"Wallet mini app"}),(0,s.jsxs)("div",{className:"divide-y divide-[#222]",children:[(0,s.jsxs)(c(),{href:"/settings",className:"flex items-center justify-between py-3",children:[(0,s.jsx)("span",{children:"⚙️ Settings"}),(0,s.jsx)("span",{children:"›"})]}),(0,s.jsxs)("a",{href:"https://t.me/dopewalletbot",target:"_blank",rel:"noreferrer",className:"flex items-center justify-between py-3",children:[(0,s.jsx)("span",{children:"\uD83E\uDD16 Open Bot"}),(0,s.jsx)("span",{children:"›"})]}),(0,s.jsxs)("button",{onClick:()=>window.location.reload(),className:"flex items-center justify-between py-3 w-full",children:[(0,s.jsx)("span",{children:"\uD83D\uDD04 Reload Page"}),(0,s.jsx)("span",{children:"›"})]}),(0,s.jsxs)(c(),{href:"/terms",className:"flex items-center justify-between py-3",children:[(0,s.jsx)("span",{children:"\uD83D\uDCC4 Terms of Use"}),(0,s.jsx)("span",{children:"›"})]}),(0,s.jsxs)(c(),{href:"/privacy",className:"flex items-center justify-between py-3",children:[(0,s.jsx)("span",{children:"\uD83D\uDD12 Privacy Policy"}),(0,s.jsx)("span",{children:"›"})]}),(0,s.jsxs)("button",{onClick:()=>{try{localStorage.removeItem("dopewallet_signedin")}catch(e){}try{window.dispatchEvent(new Event("dopewallet:signout"))}catch(e){}window.location.reload()},className:"flex items-center justify-between py-3 text-sm w-full",children:[(0,s.jsx)("span",{children:"\uD83D\uDD13 Sign out"}),(0,s.jsx)("span",{children:"›"})]}),(0,s.jsxs)("button",{className:"flex items-center justify-between py-3 text-red-500 w-full",children:[(0,s.jsx)("span",{children:"\uD83D\uDDD1 Remove from Menu"}),(0,s.jsx)("span",{children:"›"})]})]}),(0,s.jsx)("button",{onClick:t,className:"mt-4 w-full bg-[#222] rounded-xl py-2 text-sm text-textDim",children:"Close"})]})},"menu")})}var x=n(3454);function h(){let[e,t]=(0,a.useState)(!1),[n,l]=(0,a.useState)(null),c=(0,i.useRouter)();return(0,a.useEffect)(()=>{try{var e,t,n;let s=null===(e=window.Telegram)||void 0===e?void 0:e.WebApp,a=(null==s?void 0:null===(n=s.initDataUnsafe)||void 0===n?void 0:null===(t=n.user)||void 0===t?void 0:t.id)||(null==s?void 0:s.initData)&&(()=>{try{var e;return null===(e=JSON.parse(s.initData).user)||void 0===e?void 0:e.id}catch(e){return null}})();if(!a)return;(async()=>{try{var e;let t=x.env.NEXT_PUBLIC_BACKEND_URL||"https://dopewalletbot-production.up.railway.app",n=await r.Z.get("".concat(t,"/profile/by_telegram/").concat(a));l((null===(e=n.data)||void 0===e?void 0:e.avatar_url)||null)}catch(e){}})()}catch(e){}},[]),(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-bg",children:[(0,s.jsx)("button",{onClick:()=>c.push("/profile?edit=true"),className:"flex items-center gap-2",children:n?(0,s.jsx)("img",{src:n,alt:"avatar",className:"w-8 h-8 rounded-full object-cover"}):(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-[#222] flex items-center justify-center",children:(0,s.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:[(0,s.jsx)("circle",{cx:"12",cy:"8",r:"3",stroke:"rgba(255,255,255,0.7)",strokeWidth:"1.6",fill:"none"}),(0,s.jsx)("path",{d:"M4 20c1.5-4 6-6 8-6s6.5 2 8 6",stroke:"rgba(255,255,255,0.7)",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})]})})}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{className:"font-semibold",children:"\xa0"})}),(0,s.jsx)("button",{onClick:()=>t(!0),className:"text-textDim hover:text-white p-1",children:(0,s.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:[(0,s.jsx)("circle",{cx:"5",cy:"12",r:"1.5",stroke:"rgba(255,255,255,0.7)",strokeWidth:"1.6",fill:"none"}),(0,s.jsx)("circle",{cx:"12",cy:"12",r:"1.5",stroke:"rgba(255,255,255,0.7)",strokeWidth:"1.6",fill:"none"}),(0,s.jsx)("circle",{cx:"19",cy:"12",r:"1.5",stroke:"rgba(255,255,255,0.7)",strokeWidth:"1.6",fill:"none"})]})}),e&&(0,s.jsx)(u,{onClose:()=>t(!1)})]})}},1441:function(e,t,n){"use strict";n.d(t,{EK:function(){return x},wb:function(){return m},FV:function(){return h}});var s=n(7191),a=n.n(s),i=n(2153),r=n(2678),l=n(95);async function c(e,t){let n=new TextEncoder,s=await crypto.subtle.importKey("raw",n.encode(e),"PBKDF2",!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:1e5,hash:"SHA-256"},s,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function o(e,t){let n=crypto.getRandomValues(new Uint8Array(12)),s=crypto.getRandomValues(new Uint8Array(16)),a=await c(e,s),i=new TextEncoder().encode(JSON.stringify(t)),r=new Uint8Array(await crypto.subtle.encrypt({name:"AES-GCM",iv:n},a,i));return btoa(JSON.stringify({iv:Array.from(n),salt:Array.from(s),ct:Array.from(r)}))}async function d(e,t){let{iv:n,salt:s,ct:a}=JSON.parse(atob(t)),i=await c(e,new Uint8Array(s)),r=await crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(n)},i,new Uint8Array(a));return JSON.parse(new TextDecoder().decode(new Uint8Array(r)))}let u="DW_VAULT_V1";async function x(){let e=i.OF(128),t=await i.OI(e),{key:n}=(0,r.derivePath)("m/44'/501'/0'/0'",t.toString("hex")),s=l.RG.fromSeed(n);return{pubkey:s.publicKey.toBase58(),pkBase58:a().encode(s.secretKey),mnemonic:e,createdAt:Date.now()}}async function h(e,t){let n=await o(e,t);localStorage.setItem(u,n)}async function m(e){let t=localStorage.getItem(u);return t?await d(e,t):null}},933:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var s=n(5893),a=n(7294),i=n(6469),r=n(1441),l=n(1163),c=n(3495);function o(){let e=(0,l.useRouter)(),[t,n]=(0,a.useState)(""),[o,d]=(0,a.useState)(null),[u,x]=(0,a.useState)(null),[h,m]=(0,a.useState)(!1),[p,f]=(0,a.useState)(!1),[y,w]=(0,a.useState)(!1),[j,b]=(0,a.useState)(!1);async function v(e){null==e||e.preventDefault(),x(null),m(!0);try{let e=await (0,r.wb)(t);e?d(e):x("Invalid password or no wallet found in session storage.")}catch(e){x(e.message||String(e))}finally{m(!1)}}return(0,s.jsxs)("div",{className:"min-h-screen bg-bg text-white pb-24",children:[(0,s.jsx)(i.Z,{}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h1",{className:"text-lg font-semibold mb-2",children:"Backup & Recovery Phrase"}),(0,s.jsx)("p",{className:"text-textDim text-sm mb-4",children:"This screen lets you reveal the Secret Recovery Phrase for your wallet. Keep it offline and never share it."}),!o&&(0,s.jsxs)("form",{onSubmit:v,className:"space-y-3",children:[(0,s.jsx)("label",{className:"block text-xs text-textDim",children:"Enter your wallet password to unlock"}),(0,s.jsx)("input",{value:t,onChange:e=>n(e.target.value),type:"password",placeholder:"Password",className:"w-full bg-[#111] border border-line rounded-xl p-2"}),u&&(0,s.jsx)("div",{className:"text-red-500 text-sm",children:u}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{type:"submit",className:"bg-accent rounded-xl py-2 px-4",children:h?"Unlocking…":"Unlock"}),(0,s.jsx)("button",{type:"button",onClick:()=>e.back(),className:"bg-[#222] rounded-xl py-2 px-4 text-textDim",children:"Back"})]})]}),o&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"bg-card rounded-xl p-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h2",{className:"text-sm text-textDim",children:"Secret Recovery Phrase"}),(0,s.jsx)("p",{className:"text-xs text-textDim mt-1",children:"Keep this phrase private. Anyone with it can access your funds."})]}),(0,s.jsx)("div",{className:"ml-3",children:(0,s.jsx)("button",{onClick:()=>f(e=>!e),className:"text-sm text-[#3B82F6]",children:p?"Hide":"Reveal"})})]}),(0,s.jsx)(c.E.pre,{initial:{opacity:0},animate:{opacity:1},className:"mt-3 p-3 bg-[#0A0A0B] rounded-lg text-xs break-words",style:{whiteSpace:"pre-wrap"},children:p?o.mnemonic:"Hidden (reveal to show recovery phrase)"}),(0,s.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,s.jsx)("button",{onClick:function(){if(null==o?void 0:o.mnemonic)try{navigator.clipboard.writeText(o.mnemonic),b(!0),setTimeout(()=>b(!1),2e3)}catch(e){x("Copy failed")}},className:"bg-[#222] rounded-xl py-2 px-3 text-sm",children:j?"Copied":"Copy"}),(0,s.jsx)("button",{onClick:()=>navigator.share?navigator.share({text:o.mnemonic}):alert("Sharing not supported"),className:"bg-[#222] rounded-xl py-2 px-3 text-sm",children:"Share"})]})]}),(0,s.jsxs)("div",{className:"bg-[#0B0B0B] p-4 rounded-xl",children:[(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:y,onChange:e=>w(e.target.checked)}),(0,s.jsx)("span",{className:"text-xs text-textDim",children:"I have written down my recovery phrase and stored it offline."})]}),(0,s.jsxs)("div",{className:"mt-3 flex gap-2",children:[(0,s.jsx)("button",{onClick:function(){if(!y)return alert("Please confirm you have saved your recovery phrase safely.");e.push("/")},className:"bg-accent rounded-xl py-2 px-4",children:"Finish"}),(0,s.jsx)("button",{onClick:()=>d(null),className:"bg-[#222] rounded-xl py-2 px-4 text-textDim",children:"Lock"})]})]})]})]})]})}},2361:function(){},4616:function(){},5024:function(){},5545:function(){}},function(e){e.O(0,[818,664,717,888,774,179],function(){return e(e.s=139)}),_N_E=e.O()}]);