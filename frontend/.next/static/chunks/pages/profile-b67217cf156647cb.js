(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{9134:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return a(7870)}])},2896:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var l=a(5893),s=a(1664),n=a.n(s),i=a(1163);function r(){let e=(0,i.useRouter)(),t=e.pathname.startsWith("/swap")?"swap":e.pathname.startsWith("/earn")?"earn":e.pathname.startsWith("/profile")?"profile":e.pathname.startsWith("/browser")?"browser":"wallet",a=e=>{let{href:t,label:a,active:s}=e;return(0,l.jsxs)(n(),{href:t,className:"flex flex-col items-center text-xs ".concat(s?"text-white":"text-textDim"),children:[(0,l.jsx)("div",{className:"w-9 h-9 rounded-full flex items-center justify-center ".concat(s?"bg-accent/20":"bg-[#171717]"),children:"Wallet"===a?"\uD83D\uDD37":"Swap"===a?"\uD83D\uDD01":"Profile"===a?"\uD83E\uDEAA":"Browser"===a?"\uD83E\uDDED":"%"}),(0,l.jsx)("div",{className:"mt-1",children:a})]})};return(0,l.jsxs)("nav",{className:"fixed bottom-0 inset-x-0 bg-bg border-t border-line py-2 flex justify-around",children:[(0,l.jsx)(a,{href:"/",label:"Wallet",active:"wallet"===t}),(0,l.jsx)(a,{href:"/swap",label:"Swap",active:"swap"===t}),(0,l.jsx)(a,{href:"/profile",label:"Profile",active:"profile"===t}),(0,l.jsx)(a,{href:"/browser",label:"Browser",active:"browser"===t})]})}},6469:function(e,t,a){"use strict";a.d(t,{Z:function(){return m}});var l=a(5893),s=a(7294),n=a(1163),i=a(7066),r=a(1664),c=a.n(r),o=a(1526),d=a(3495);function u(e){let{onClose:t}=e;return(0,l.jsx)(o.M,{children:(0,l.jsx)(d.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/60 flex flex-col justify-end",onClick:t,children:(0,l.jsxs)(d.E.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{duration:.28},className:"bg-[#111] rounded-t-2xl text-white p-4 space-y-2",onClick:e=>e.stopPropagation(),children:[(0,l.jsx)("div",{className:"w-16 h-1 bg-[#333] rounded-full mx-auto mb-3"}),(0,l.jsx)("h3",{className:"text-center text-sm font-semibold text-textDim mb-2",children:"Wallet mini app"}),(0,l.jsxs)("div",{className:"divide-y divide-[#222]",children:[(0,l.jsxs)(c(),{href:"/settings",className:"flex items-center justify-between py-3",children:[(0,l.jsx)("span",{children:"⚙️ Settings"}),(0,l.jsx)("span",{children:"›"})]}),(0,l.jsxs)("a",{href:"https://t.me/dopewalletbot",target:"_blank",rel:"noreferrer",className:"flex items-center justify-between py-3",children:[(0,l.jsx)("span",{children:"\uD83E\uDD16 Open Bot"}),(0,l.jsx)("span",{children:"›"})]}),(0,l.jsxs)("button",{onClick:()=>window.location.reload(),className:"flex items-center justify-between py-3 w-full",children:[(0,l.jsx)("span",{children:"\uD83D\uDD04 Reload Page"}),(0,l.jsx)("span",{children:"›"})]}),(0,l.jsxs)(c(),{href:"/terms",className:"flex items-center justify-between py-3",children:[(0,l.jsx)("span",{children:"\uD83D\uDCC4 Terms of Use"}),(0,l.jsx)("span",{children:"›"})]}),(0,l.jsxs)(c(),{href:"/privacy",className:"flex items-center justify-between py-3",children:[(0,l.jsx)("span",{children:"\uD83D\uDD12 Privacy Policy"}),(0,l.jsx)("span",{children:"›"})]}),(0,l.jsxs)("button",{onClick:()=>{try{localStorage.removeItem("dopewallet_signedin")}catch(e){}try{window.dispatchEvent(new Event("dopewallet:signout"))}catch(e){}window.location.reload()},className:"flex items-center justify-between py-3 text-sm w-full",children:[(0,l.jsx)("span",{children:"\uD83D\uDD13 Sign out"}),(0,l.jsx)("span",{children:"›"})]}),(0,l.jsxs)("button",{className:"flex items-center justify-between py-3 text-red-500 w-full",children:[(0,l.jsx)("span",{children:"\uD83D\uDDD1 Remove from Menu"}),(0,l.jsx)("span",{children:"›"})]})]}),(0,l.jsx)("button",{onClick:t,className:"mt-4 w-full bg-[#222] rounded-xl py-2 text-sm text-textDim",children:"Close"})]})},"menu")})}var x=a(3454);function m(){let[e,t]=(0,s.useState)(!1),[a,r]=(0,s.useState)(null),c=(0,n.useRouter)();return(0,s.useEffect)(()=>{try{var e,t,a;let l=null===(e=window.Telegram)||void 0===e?void 0:e.WebApp,s=(null==l?void 0:null===(a=l.initDataUnsafe)||void 0===a?void 0:null===(t=a.user)||void 0===t?void 0:t.id)||(null==l?void 0:l.initData)&&(()=>{try{var e;return null===(e=JSON.parse(l.initData).user)||void 0===e?void 0:e.id}catch(e){return null}})();if(!s)return;(async()=>{try{var e;let t=x.env.NEXT_PUBLIC_BACKEND_URL||"https://dopewalletbot-production.up.railway.app",a=await i.Z.get("".concat(t,"/profile/by_telegram/").concat(s));r((null===(e=a.data)||void 0===e?void 0:e.avatar_url)||null)}catch(e){}})()}catch(e){}},[]),(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 border-b border-line bg-bg",children:[(0,l.jsx)("button",{onClick:()=>c.push("/profile?edit=true"),className:"flex items-center gap-2",children:a?(0,l.jsx)("img",{src:a,alt:"avatar",className:"w-8 h-8 rounded-full object-cover"}):(0,l.jsx)("div",{className:"w-8 h-8 rounded-full bg-[#222] flex items-center justify-center text-sm",children:"\uD83D\uDC7B"})}),(0,l.jsx)("div",{className:"text-center",children:(0,l.jsx)("p",{className:"font-semibold",children:"\xa0"})}),(0,l.jsx)("button",{onClick:()=>t(!0),className:"text-2xl text-textDim hover:text-white",children:"•••"}),e&&(0,l.jsx)(u,{onClose:()=>t(!1)})]})}},7751:function(e,t,a){"use strict";a.d(t,{QY:function(){return i},Sm:function(){return r},xp:function(){return n}});var l=a(7066);let s=a(3454).env.NEXT_PUBLIC_BACKEND_URL||"https://dopewalletbot-production.up.railway.app";async function n(e){try{return(await l.Z.get("".concat(s,"/api/wallet/portfolio"),{params:{pubkey:e}})).data}catch(e){var t;return console.warn("getPortfolio failed",null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.status,null==e?void 0:e.message),{tokens:[],lp:[],balance:0}}}async function i(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;return(await l.Z.post("".concat(s,"/swap/quote"),{inputMint:e,outputMint:t,amount:a,slippageBps:n})).data}async function r(e,t){return(await l.Z.post("".concat(s,"/swap/execute"),{userPrivateKey:e,route:t})).data}},1441:function(e,t,a){"use strict";a.d(t,{EK:function(){return x},wb:function(){return f},FV:function(){return m}});var l=a(7191),s=a.n(l),n=a(2153),i=a(2678),r=a(95);async function c(e,t){let a=new TextEncoder,l=await crypto.subtle.importKey("raw",a.encode(e),"PBKDF2",!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:1e5,hash:"SHA-256"},l,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function o(e,t){let a=crypto.getRandomValues(new Uint8Array(12)),l=crypto.getRandomValues(new Uint8Array(16)),s=await c(e,l),n=new TextEncoder().encode(JSON.stringify(t)),i=new Uint8Array(await crypto.subtle.encrypt({name:"AES-GCM",iv:a},s,n));return btoa(JSON.stringify({iv:Array.from(a),salt:Array.from(l),ct:Array.from(i)}))}async function d(e,t){let{iv:a,salt:l,ct:s}=JSON.parse(atob(t)),n=await c(e,new Uint8Array(l)),i=await crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(a)},n,new Uint8Array(s));return JSON.parse(new TextDecoder().decode(new Uint8Array(i)))}let u="DW_VAULT_V1";async function x(){let e=n.OF(128),t=await n.OI(e),{key:a}=(0,i.derivePath)("m/44'/501'/0'/0'",t.toString("hex")),l=r.RG.fromSeed(a);return{pubkey:l.publicKey.toBase58(),pkBase58:s().encode(l.secretKey),mnemonic:e,createdAt:Date.now()}}async function m(e,t){let a=await o(e,t);sessionStorage.setItem(u,a)}async function f(e){let t=sessionStorage.getItem(u);return t?await d(e,t):null}},7870:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return x}});var l=a(5893),s=a(7294),n=a(1163),i=a(7066),r=a(6469),c=a(2896),o=a(1441),d=a(7751),u=a(3454);function x(){var e,t,a,x;let[m,f]=(0,s.useState)(null),[p,v]=(0,s.useState)(null),[h,y]=(0,s.useState)(null),[b,w]=(0,s.useState)(null),j=(0,n.useRouter)(),N=j.query.username||null,[g,D]=(0,s.useState)(null),[_,S]=(0,s.useState)(!0),[E,C]=(0,s.useState)(!1),[k,A]=(0,s.useState)({display_name:"",username:"",avatar_url:"",bio:""}),[U,P]=(0,s.useState)(!1),[B,T]=(0,s.useState)(!1),F=u.env.NEXT_PUBLIC_BACKEND_URL||"https://dopewalletbot-production.up.railway.app",R=()=>{var e,t,a;let l=null===(e=window.Telegram)||void 0===e?void 0:e.WebApp;return l?(null==l?void 0:null===(a=l.initDataUnsafe)||void 0===a?void 0:null===(t=a.user)||void 0===t?void 0:t.id)||(null==l?void 0:l.initData)&&(()=>{try{var e;return null===(e=JSON.parse(l.initData).user)||void 0===e?void 0:e.id}catch(e){return null}})():null};(0,s.useEffect)(()=>{(async()=>{let e=sessionStorage.getItem("DW_LAST_PW");if(e){let t=await (0,o.wb)(e);f(t),(null==t?void 0:t.pubkey)&&v(await (0,d.xp)(t.pubkey))}})()},[]),(0,s.useEffect)(()=>{(async()=>{S(!0);try{let e;let t=R();if(N)e=await i.Z.get("".concat(F,"/profile/").concat(N));else if(t)e=await i.Z.get("".concat(F,"/profile/by_telegram/").concat(t));else{D(null),S(!1);return}D(e.data)}catch(t){var e;console.error("Failed to load profile",(null==t?void 0:null===(e=t.response)||void 0===e?void 0:e.data)||t.message||t),D(null)}finally{S(!1)}})()},[N]),(0,s.useEffect)(()=>{var e;(null===(e=j.query)||void 0===e?void 0:e.edit)==="true"&&W()},[j.query]);let W=()=>{A({display_name:(null==g?void 0:g.display_name)||(null==g?void 0:g.username)||"",username:(null==g?void 0:g.username)||"",avatar_url:(null==g?void 0:g.avatar_url)||"",bio:(null==g?void 0:g.bio)||""}),C(!0)},O=async()=>{try{var e;let t=R();if(!t&&!confirm("Telegram not detected. Save profile locally?"))return;let a={telegramId:t||null,username:k.username,displayName:k.display_name,avatarUrl:k.avatar_url,bio:k.bio},l=await i.Z.post("".concat(F,"/profile/create"),a);(null===(e=l.data)||void 0===e?void 0:e.success)?(D(l.data.profile),C(!1)):alert("Error saving profile")}catch(e){console.error(e),alert("Error saving profile")}},Z=async()=>{try{var e,t;T(!0);let a=R();if(!a)return alert("Open inside Telegram to follow users.");let l=await i.Z.post("".concat(F,"/profile/follow"),{follower:a,following:g.username});(null===(e=l.data)||void 0===e?void 0:e.action)==="followed"&&P(!0),(null===(t=l.data)||void 0===t?void 0:t.action)==="unfollowed"&&P(!1)}catch(e){console.error(e),alert("Unable to follow/unfollow")}finally{T(!1)}};return(0,s.useEffect)(()=>{(async()=>{let e=sessionStorage.getItem("DW_LAST_PW");if(e){let t=await (0,o.wb)(e);f(t),(null==t?void 0:t.pubkey)&&v(await (0,d.xp)(t.pubkey))}})()},[]),(0,l.jsxs)("div",{className:"min-h-screen bg-bg text-white pb-24",children:[(0,l.jsx)(r.Z,{}),(0,l.jsxs)("div",{className:"p-4 space-y-4",children:[(0,l.jsxs)("div",{className:"card bg-card rounded-xl p-4 text-center space-y-3",children:[(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)("div",{className:"avatar",children:(0,l.jsx)("div",{className:"w-16 h-16 rounded-full bg-[#222] flex items-center justify-center text-2xl",children:"\uD83D\uDC7B"})})}),(0,l.jsx)("div",{className:"text-lg font-semibold",children:(null==g?void 0:g.display_name)||(m?"@"+m.pubkey.slice(0,6)+"...":"Anonymous")}),(0,l.jsx)("div",{className:"text-sm text-textDim",children:(null==g?void 0:g.bio)||"The dopest wallet on Solana \uD83D\uDD25"}),(0,l.jsxs)("div",{className:"stats stats-vertical sm:stats-horizontal shadow-none bg-transparent p-0",children:[(0,l.jsxs)("div",{className:"stat",children:[(0,l.jsx)("div",{className:"stat-value",children:null!==(a=null==g?void 0:g.followers)&&void 0!==a?a:"-"}),(0,l.jsx)("div",{className:"stat-desc text-textDim",children:"Followers"})]}),(0,l.jsxs)("div",{className:"stat",children:[(0,l.jsx)("div",{className:"stat-value",children:null!==(x=null==g?void 0:g.following)&&void 0!==x?x:"-"}),(0,l.jsx)("div",{className:"stat-desc text-textDim",children:"Following"})]})]}),(0,l.jsxs)("div",{className:"flex justify-center gap-3",children:[(0,l.jsx)("button",{onClick:W,className:"btn btn-primary rounded-xl py-2 px-6 font-semibold text-sm",children:"Edit Profile"}),(0,l.jsx)("button",{disabled:B,onClick:Z,className:"btn btn-ghost rounded-xl py-2 px-6",children:U?"Following":"Follow"})]})]}),(0,l.jsxs)("div",{className:"bg-card rounded-xl p-4 space-y-3",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("div",{className:"text-sm font-semibold",children:"Followed Tokens"}),(0,l.jsx)("button",{className:"text-[#3B82F6] text-xs",children:"See All ›"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[null==p?void 0:null===(e=p.tokens)||void 0===e?void 0:e.slice(0,3).map(e=>{var t;return(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("img",{src:e.logo,className:"w-6 h-6 rounded-full",alt:e.symbol}),(0,l.jsx)("div",{className:"text-sm",children:e.symbol})]}),(0,l.jsxs)("div",{className:"text-sm text-textDim",children:["$",(null!==(t=e.price)&&void 0!==t?t:0).toFixed(2)]})]},e.mint)}),!(null==p?void 0:null===(t=p.tokens)||void 0===t?void 0:t.length)&&(0,l.jsx)("div",{className:"text-xs text-textDim text-center py-2",children:"You haven’t followed any tokens yet."})]})]}),(0,l.jsxs)("div",{className:"bg-card rounded-xl p-4 space-y-2",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("div",{className:"text-sm font-semibold",children:"Recent Activity"}),(0,l.jsx)("button",{className:"text-[#3B82F6] text-xs",children:"View More ›"})]}),(0,l.jsx)("div",{className:"text-xs text-textDim",children:"No recent activity available."})]}),E&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",children:(0,l.jsxs)("div",{className:"bg-neutral card p-4 w-96",children:[(0,l.jsx)("h3",{className:"font-bold mb-2",children:"Edit Profile"}),(0,l.jsx)("label",{className:"label",children:(0,l.jsx)("span",{className:"label-text",children:"Display name"})}),(0,l.jsx)("input",{className:"input w-full mb-2",value:k.display_name,onChange:e=>A({...k,display_name:e.target.value})}),(0,l.jsx)("label",{className:"label",children:(0,l.jsx)("span",{className:"label-text",children:"Username"})}),(0,l.jsx)("input",{className:"input w-full mb-2",value:k.username,onChange:e=>A({...k,username:e.target.value})}),(0,l.jsx)("label",{className:"label",children:(0,l.jsx)("span",{className:"label-text",children:"Avatar (upload)"})}),(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;let l=new FileReader;l.onload=()=>{A(e=>({...e,avatar_url:String(l.result)}))},l.readAsDataURL(a)}}),k.avatar_url&&(0,l.jsx)("img",{src:k.avatar_url,alt:"preview",className:"w-12 h-12 rounded-full object-cover"})]}),(0,l.jsx)("label",{className:"label",children:(0,l.jsx)("span",{className:"label-text",children:"Bio"})}),(0,l.jsx)("textarea",{className:"textarea w-full mb-2",value:k.bio,onChange:e=>A({...k,bio:e.target.value})}),(0,l.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,l.jsx)("button",{className:"btn",onClick:()=>C(!1),children:"Cancel"}),(0,l.jsx)("button",{className:"btn btn-primary",onClick:O,children:"Save"})]})]})})]}),(0,l.jsx)(c.Z,{})]})}},2361:function(){},4616:function(){},5024:function(){},5545:function(){}},function(e){e.O(0,[818,664,717,888,774,179],function(){return e(e.s=9134)}),_N_E=e.O()}]);