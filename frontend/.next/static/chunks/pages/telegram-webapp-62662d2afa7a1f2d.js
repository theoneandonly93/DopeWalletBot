(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[889],{353:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/telegram-webapp",function(){return t(638)}])},638:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return l}});var n=t(5893),r=t(7294);function l(){let[e,a]=(0,r.useState)(null),[t,l]=(0,r.useState)("idle"),[i,s]=(0,r.useState)(null),[c,o]=(0,r.useState)(void 0);(0,r.useEffect)(()=>{var e;let t=null===(e=window.Telegram)||void 0===e?void 0:e.WebApp;if(t){a(t.initData);try{t.expand()}catch(e){}}else l("not-in-telegram")},[]);let d=async()=>{l("verifying");try{let a=await fetch("/api/telegram/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({initData:e})}),t=await a.json();if(!a.ok)throw Error(t.error||"verify failed");l("verified")}catch(e){l("error:"+(e.message||e))}},u=async()=>{l("creating");try{var a;let t=await fetch("/wallet/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({telegramId:null==e?void 0:null===(a=e.user)||void 0===a?void 0:a.id})}),n=await t.json();if(!t.ok)throw Error(n.error||"create failed");l("wallet-created"),s(n.wallet)}catch(e){l("error:"+(e.message||e))}},h=async()=>{l("fetching-balance");try{var a;let t=null==e?void 0:null===(a=e.user)||void 0===a?void 0:a.id,n=await fetch("/wallet/balance/".concat(t)),r=await n.json();if(!n.ok)throw Error(r.error||"balance failed");l("balance-fetched"),o(r.balance)}catch(e){l("error:"+(e.message||e))}};return(0,n.jsxs)("div",{className:"p-4 text-white bg-phantom-bg min-h-screen",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"DopeWallet (Telegram)"}),(0,n.jsx)("p",{className:"text-sm text-gray-300 mt-2",children:"Open this inside Telegram to use as a wallet tab."}),(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)("pre",{className:"text-xs bg-gray-900 p-2 rounded",children:e||"No Telegram WebApp env detected."})}),(0,n.jsxs)("div",{className:"mt-4 space-x-2",children:[(0,n.jsx)("button",{className:"btn btn-primary",onClick:d,children:"Verify initData"}),(0,n.jsx)("button",{className:"btn btn-secondary",onClick:u,children:"Create Wallet"}),(0,n.jsx)("button",{className:"btn btn-ghost",onClick:h,children:"Get Balance"}),(0,n.jsx)("span",{className:"ml-3",children:t})]}),i&&(0,n.jsx)("div",{className:"mt-4 bg-gray-900 p-3 rounded",children:(0,n.jsxs)("div",{children:["Public Key: ",i.publicKey]})}),void 0!==c&&(0,n.jsxs)("div",{className:"mt-4 bg-gray-900 p-3 rounded",children:["Balance: ",c," SOL"]})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=353)}),_N_E=e.O()}]);