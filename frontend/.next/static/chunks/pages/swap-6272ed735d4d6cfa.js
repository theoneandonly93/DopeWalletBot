(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[503],{9238:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/swap",function(){return s(8043)}])},8043:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var n=s(5893),a=s(7294),l=s(6469),i=s(2896),r=s(1664),o=s.n(r);function d(e){let{tokens:t=[],chain:s="solana"}=e;return(0,n.jsxs)("div",{className:"bg-[#111] rounded-2xl border border-[#222] p-3 mt-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,n.jsx)("h2",{className:"text-xs text-textDim font-semibold",children:"TRENDING"}),(0,n.jsx)("div",{className:"text-xs px-2 py-1 rounded-full bg-[#0b0b0b] border border-[#222]",children:(0,n.jsx)("span",{className:"font-mono text-[11px] uppercase",children:s})})]}),t.map(e=>{var t,a,l,i,r,d,c,u;let m=null!==(i=null!==(l=null==e?void 0:e.price)&&void 0!==l?l:null==e?void 0:e.value)&&void 0!==i?i:0,x=Number(m),b=Number.isFinite(x)?x.toFixed(4):String(m||0),h=null!==(d=null!==(r=null==e?void 0:e.change24h)&&void 0!==r?r:null==e?void 0:e.change_24h)&&void 0!==d?d:0,p=Number(h),v=Number.isFinite(p)?p.toFixed(2):String(h||0),f=Number(null!==(u=null!==(c=null==e?void 0:e.volume24h)&&void 0!==c?c:null==e?void 0:e.volume_24h)&&void 0!==u?u:0)||0,w=e.logoURI||(null===(t=e.raw)||void 0===t?void 0:t.icon)||"";!w||w.startsWith("http")||w.startsWith("/")||(w="https://cdn.dexscreener.com/token-images/".concat(s,"/").concat(e.address||e.tokenAddress||"")),w||(w="bsc"===s?"/bnb.svg":"/sol.svg");let g=e.symbol||e.tokenSymbol||(null===(a=e.raw)||void 0===a?void 0:a.symbol)||(e.address?"".concat(String(e.address).slice(0,4),"...").concat(String(e.address).slice(-4)):"UNKNOWN");return(0,n.jsxs)(o(),{href:"/token/".concat(e.address||e.tokenAddress||""),className:"flex items-center justify-between py-2 border-b border-[#222] last:border-0 hover:bg-[#0b0b0b] px-2 rounded-md",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("img",{src:w,alt:g,className:"w-8 h-8 rounded-full"}),(0,n.jsx)("div",{className:"absolute -bottom-1 -right-1 bg-[#0b0b0b] border border-[#222] rounded-full w-5 h-5 flex items-center justify-center",children:(0,n.jsx)("span",{className:"text-[10px] font-semibold text-white uppercase",children:"bsc"===s?"B":"S"})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-semibold",children:g}),(0,n.jsx)("p",{className:"text-xs text-textDim truncate w-40",children:e.name||e.tokenName||""}),(0,n.jsx)("p",{className:"text-xs text-textDim",children:f>0?"$".concat(f.toLocaleString()," Vol"):""})]})]}),(0,n.jsxs)("div",{className:"text-right",children:[(0,n.jsxs)("p",{className:"text-sm font-semibold",children:["$",b]}),(0,n.jsxs)("p",{className:"".concat(p>=0?"text-green-400":"text-red-400"," text-xs"),children:[v,"%"]})]})]},e.address||e.tokenAddress||e.id)})]})}var c=s(7751),u=s(4146),m=s(7200),x=s(2790);let b="0x10ED43C718714eb63d5aA57B78B54704E256024E",h=["function getAmountsOut(uint amountIn, address[] memory path) external view returns (uint[] memory amounts)","function swapExactTokensForTokens(uint amountIn, uint amountOutMin, address[] calldata path, address to, uint deadline) external returns (uint[] memory amounts)","function swapExactETHForTokens(uint amountOutMin, address[] calldata path, address to, uint deadline) external payable returns (uint[] memory amounts)","function swapExactTokensForETH(uint amountIn, uint amountOutMin, address[] calldata path, address to, uint deadline) external returns (uint[] memory amounts)"];async function p(e){let{amountIn:t,path:s,rpcUrl:n}=e,a=function(e){if(!e)throw Error("rpcUrl required");return new u.r6(e)}(n),l=new m.CH(b,h,a);return await l.getAmountsOut(t,s)}async function v(e){let{signer:t,tx:s}=e;if(!t)throw Error("Signer required");let n=await t.populateTransaction(s);return await t.sendTransaction(n)}var f=s(8470),w=s(1376),g=s(1441),N=s(3454);function j(){let[e,t]=(0,a.useState)("0"),[s,r]=(0,a.useState)("0.00"),[o,u]=(0,a.useState)(null),[m,j]=(0,a.useState)(!1),[y,S]=(0,a.useState)("So11111111111111111111111111111111111111112"),[k,_]=(0,a.useState)("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),[T,E]=(0,a.useState)(null),[C,D]=(0,a.useState)("Most Traded"),[A,U]=(0,a.useState)([]),[F,M]=(0,a.useState)("solana");async function q(){if(!T)return alert("Unlock your wallet first.");try{j(!0);let t=await (0,c.QY)(y,k,e);u(t),r(parseFloat(t.outAmountUSD||0).toFixed(2))}catch(e){console.error(e),alert("Quote failed: "+((null==e?void 0:e.message)||e))}finally{j(!1)}}async function B(){if(!T)return alert("Unlock your wallet first.");try{j(!0);let t=o||await (0,c.QY)(y,k,e),s=prompt("Enter password to unlock your wallet for the swap:");if(!s)throw Error("Password required.");let n=await (0,g.wb)(s);if(!(null==n?void 0:n.pkBase58))throw Error("Unable to unlock vault or private key missing.");let a=await (0,c.Sm)(n.pkBase58,t);(null==a?void 0:a.success)&&a.signature?alert("Swap complete: "+a.signature):(null==a?void 0:a.signature)?alert("Swap submitted: "+a.signature):alert("Swap complete (no signature returned).")}catch(e){console.error(e),alert("Swap failed: "+((null==e?void 0:e.message)||e))}finally{j(!1)}}return N.env.NEXT_PUBLIC_RPC,(0,a.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem("DW_LAST_PW");if(e){let t=await (0,g.wb)(e);E(t)}}catch(e){}})()},[]),(0,a.useEffect)(()=>{try{let e=localStorage.getItem("swap_prefill");if(e){let t=JSON.parse(e);t.inputMint&&S(t.inputMint),t.outputMint&&_(t.outputMint),localStorage.removeItem("swap_prefill")}}catch(e){}},[]),(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/dex/trending?chain=".concat(encodeURIComponent(F))),t=await e.json(),s=(null==t?void 0:t.data)||(null==t?void 0:t.pairs)||t||[],n=(Array.isArray(s)?s:[]).map(e=>{var t,s,n,a,l,i,r,o;let d=e.tokenAddress||e.address||e.pairAddress||(null===(t=e.baseToken)||void 0===t?void 0:t.address)||(null===(s=e.quoteToken)||void 0===s?void 0:s.address)||e.id||"",c=e.icon||e.logo||e.logoURI||e.tokenIcon||(null===(n=e.baseToken)||void 0===n?void 0:n.icon)||(null===(a=e.quoteToken)||void 0===a?void 0:a.icon)||"",u=e.symbol||e.tokenSymbol||(null===(l=e.token)||void 0===l?void 0:l.symbol)||(null===(i=e.baseToken)||void 0===i?void 0:i.symbol)||(null===(r=e.quoteToken)||void 0===r?void 0:r.symbol)||e.name||"",m=Number(e.priceUsd||e.price||e.tokenPrice||e.price_usd||(null===(o=e.baseToken)||void 0===o?void 0:o.price)||0)||0,x=Number(e.priceChange||e.change||e.change_24h||e.price_change_percentage_24h||0)||0,b=Number(e.volume||e.volume24h||e.volume_24h||e.quoteVolume||e.liquidity||0)||0;return{address:d,logoURI:c,symbol:u,price:m,change24h:x,volume24h:b}});U(n)}catch(e){console.error("Trending fetch failed",e)}})()},[F]),(0,a.useEffect)(()=>{},[]),(0,n.jsxs)("div",{className:"min-h-screen bg-bg text-white pb-24",children:[(0,n.jsx)(l.Z,{}),(0,n.jsxs)("div",{className:"p-4 space-y-3",children:[(0,n.jsxs)("div",{className:"rounded-xl p-4 space-y-4 relative bg-card",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-textDim text-xs mb-1",children:"You swap"}),(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("input",{type:"number",value:e,onChange:e=>t(e.target.value),className:"input input-ghost text-3xl outline-none w-2/3",placeholder:"0"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)("div",{className:"badge badge-outline rounded-full px-2 py-1 text-sm flex items-center gap-1",children:[(0,n.jsx)("img",{src:"/sol.svg",alt:"SOL",className:"w-4 h-4"}),"SOL"]}),(0,n.jsx)("button",{className:"btn btn-ghost btn-sm",children:"Deposit"})]})]}),(0,n.jsxs)("div",{className:"text-textDim text-sm",children:["$",s]})]}),(0,n.jsx)("div",{className:"absolute left-1/2 transform -translate-x-1/2 -bottom-4 bg-bg rounded-full w-8 h-8 flex items-center justify-center",children:(0,n.jsx)("div",{className:"rotate-90",children:"⇅"})}),(0,n.jsxs)("div",{className:"pt-8",children:[(0,n.jsx)("div",{className:"text-textDim text-xs mb-1",children:"You receive"}),(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("input",{type:"text",disabled:!0,value:o?o.outAmountUi:"0",className:"input input-ghost text-3xl outline-none w-2/3"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)("div",{className:"badge badge-outline rounded-full px-2 py-1 text-sm flex items-center gap-1",children:[(0,n.jsx)("img",{src:"/usdc.png",alt:"USDC",className:"w-4 h-4"}),"USDC"]}),(0,n.jsx)("button",{className:"btn btn-ghost btn-sm",children:"›"})]})]}),(0,n.jsxs)("div",{className:"text-textDim text-sm",children:["$",s]})]})]}),(0,n.jsx)("button",{onClick:async()=>{if("bsc"===F)try{let t=N.env.NEXT_PUBLIC_BSC_RPC||"https://bsc-dataseed.binance.org/",s=f.vz(String(e||"0"),18),n=[y,k],a=await p({amountIn:s,path:n,rpcUrl:t}),l=a[a.length-1];u({outAmount:l.toString(),outAmountUi:f.bM(l,18)}),r((Number(f.bM(l,18))||0).toFixed(2))}catch(e){console.error("BSC quote failed",e),alert("BSC quote failed: "+((null==e?void 0:e.message)||e))}else await q()},disabled:m,className:"btn btn-primary w-full",children:m?"Fetching...":"Get Quote"}),(0,n.jsx)("button",{onClick:async()=>{if("bsc"===F){var t;if(!(null===(t=window)||void 0===t?void 0:t.ethereum))return alert("No injected wallet found. Please connect a Web3 wallet (MetaMask).");try{j(!0),await window.ethereum.request({method:"eth_requestAccounts"});let t=new w.Q(window.ethereum),s=await t.getSigner();N.env.NEXT_PUBLIC_BSC_RPC;let n=f.vz(String(e||"0"),18),a=Math.floor(Date.now()/1e3)+600,l=function(e){let{amountIn:t,amountOutMin:s,path:n,to:a,deadline:l}=e;return{to:b,data:new x.vU(h).encodeFunctionData("swapExactTokensForTokens",[t,s,n,a,l])}}({amountIn:n,amountOutMin:0,path:[y,k],to:await s.getAddress(),deadline:a}),i=await v({signer:s,tx:l});alert("Swap submitted: "+i.hash)}catch(e){console.error(e),alert("Swap failed: "+((null==e?void 0:e.message)||e))}finally{j(!1)}}else await B()},disabled:m,className:"btn w-full btn-outline",children:m?"Processing...":"Swap Now"})]}),(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,n.jsx)("div",{className:"text-xs text-textDim",children:"TRENDING"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{onClick:()=>M("solana"),className:"btn btn-sm ".concat("solana"===F?"btn-primary":"btn-ghost"),children:"Solana"}),(0,n.jsx)("button",{onClick:()=>M("bsc"),className:"btn btn-sm ".concat("bsc"===F?"btn-primary":"btn-ghost"),children:"BSC"})]})]}),(0,n.jsxs)("div",{className:"bg-card rounded-xl p-3",children:[(0,n.jsx)("div",{className:"flex justify-around text-sm mb-2",children:["Most Traded","All Tokens","Top Gainers","Top Losers"].map(e=>(0,n.jsx)("button",{onClick:()=>D(e),className:"py-2 w-1/4 ".concat(C===e?"text-[#3B82F6] border-b-2 border-[#3B82F6]":"text-textDim"),children:e},e))}),(0,n.jsx)(d,{tokens:A,chain:F})]})]}),(0,n.jsx)(i.Z,{})]})}}},function(e){e.O(0,[818,664,717,840,727,888,774,179],function(){return e(e.s=9238)}),_N_E=e.O()}]);